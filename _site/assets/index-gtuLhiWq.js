(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const Yr="modulepreload",Ur=function(t){return"/"+t},Ln={},mn=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=Ur(o),o in Ln)return;Ln[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!i)for(let l=r.length-1;l>=0;l--){const f=r[l];if(f.href===o&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":Yr,s||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),s)return new Promise((l,f)=>{c.addEventListener("load",l),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})},zi=()=>window.spwashi.parameters.mode,V=(t,e=!0,n=!1)=>{e&&zi()===t&&(t=null),window.spwashi.parameters.mode=t,document.body.dataset.mode=t,window.spwashi.onModeChange(t,n)};function Od(t){const e=document.querySelector("#mainmenu-shortcuts ol");e.innerHTML="",window.spwashi.modeOrder.forEach(n=>{const i=document.createElement("li");i.dataset.modeAction=n,i.dataset.interfaceElement="main-menu";const r=document.createElement("button");r.id=`mode-selector--${n}`,r.innerText=n,i.appendChild(r),e.appendChild(i)}),window.spwashi.modeOrder.forEach(n=>{const i=document.querySelector(`#mode-selector--${n}`);i.onclick=()=>{V(zi()===n?null:n)}}),V(t)}function Kr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Di={exports:{}},Oi={exports:{}};(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(n,i){return n<<i|n>>>32-i},rotr:function(n,i){return n<<32-i|n>>>i},endian:function(n){if(n.constructor==Number)return e.rotl(n,8)&16711935|e.rotl(n,24)&4278255360;for(var i=0;i<n.length;i++)n[i]=e.endian(n[i]);return n},randomBytes:function(n){for(var i=[];n>0;n--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(n){for(var i=[],r=0,o=0;r<n.length;r++,o+=8)i[o>>>5]|=n[r]<<24-o%32;return i},wordsToBytes:function(n){for(var i=[],r=0;r<n.length*32;r+=8)i.push(n[r>>>5]>>>24-r%32&255);return i},bytesToHex:function(n){for(var i=[],r=0;r<n.length;r++)i.push((n[r]>>>4).toString(16)),i.push((n[r]&15).toString(16));return i.join("")},hexToBytes:function(n){for(var i=[],r=0;r<n.length;r+=2)i.push(parseInt(n.substr(r,2),16));return i},bytesToBase64:function(n){for(var i=[],r=0;r<n.length;r+=3)for(var o=n[r]<<16|n[r+1]<<8|n[r+2],s=0;s<4;s++)r*8+s*6<=n.length*8?i.push(t.charAt(o>>>6*(3-s)&63)):i.push("=");return i.join("")},base64ToBytes:function(n){n=n.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],r=0,o=0;r<n.length;o=++r%4)o!=0&&i.push((t.indexOf(n.charAt(r-1))&Math.pow(2,-2*o+8)-1)<<o*2|t.indexOf(n.charAt(r))>>>6-o*2);return i}};Oi.exports=e})();var Gr=Oi.exports,We={utf8:{stringToBytes:function(t){return We.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(We.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(t.charCodeAt(n)&255);return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}},Fn=We;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Vr=function(t){return t!=null&&($i(t)||jr(t)||!!t._isBuffer)};function $i(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function jr(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&$i(t.slice(0,0))}(function(){var t=Gr,e=Fn.utf8,n=Vr,i=Fn.bin,r=function(o,s){o.constructor==String?s&&s.encoding==="binary"?o=i.stringToBytes(o):o=e.stringToBytes(o):n(o)?o=Array.prototype.slice.call(o,0):!Array.isArray(o)&&o.constructor!==Uint8Array&&(o=o.toString());for(var a=t.bytesToWords(o),u=o.length*8,c=1732584193,l=-271733879,f=-1732584194,d=271733878,h=0;h<a.length;h++)a[h]=(a[h]<<8|a[h]>>>24)&16711935|(a[h]<<24|a[h]>>>8)&4278255360;a[u>>>5]|=128<<u%32,a[(u+64>>>9<<4)+14]=u;for(var x=r._ff,w=r._gg,g=r._hh,p=r._ii,h=0;h<a.length;h+=16){var _=c,N=l,y=f,k=d;c=x(c,l,f,d,a[h+0],7,-680876936),d=x(d,c,l,f,a[h+1],12,-389564586),f=x(f,d,c,l,a[h+2],17,606105819),l=x(l,f,d,c,a[h+3],22,-1044525330),c=x(c,l,f,d,a[h+4],7,-176418897),d=x(d,c,l,f,a[h+5],12,1200080426),f=x(f,d,c,l,a[h+6],17,-1473231341),l=x(l,f,d,c,a[h+7],22,-45705983),c=x(c,l,f,d,a[h+8],7,1770035416),d=x(d,c,l,f,a[h+9],12,-1958414417),f=x(f,d,c,l,a[h+10],17,-42063),l=x(l,f,d,c,a[h+11],22,-1990404162),c=x(c,l,f,d,a[h+12],7,1804603682),d=x(d,c,l,f,a[h+13],12,-40341101),f=x(f,d,c,l,a[h+14],17,-1502002290),l=x(l,f,d,c,a[h+15],22,1236535329),c=w(c,l,f,d,a[h+1],5,-165796510),d=w(d,c,l,f,a[h+6],9,-1069501632),f=w(f,d,c,l,a[h+11],14,643717713),l=w(l,f,d,c,a[h+0],20,-373897302),c=w(c,l,f,d,a[h+5],5,-701558691),d=w(d,c,l,f,a[h+10],9,38016083),f=w(f,d,c,l,a[h+15],14,-660478335),l=w(l,f,d,c,a[h+4],20,-405537848),c=w(c,l,f,d,a[h+9],5,568446438),d=w(d,c,l,f,a[h+14],9,-1019803690),f=w(f,d,c,l,a[h+3],14,-187363961),l=w(l,f,d,c,a[h+8],20,1163531501),c=w(c,l,f,d,a[h+13],5,-1444681467),d=w(d,c,l,f,a[h+2],9,-51403784),f=w(f,d,c,l,a[h+7],14,1735328473),l=w(l,f,d,c,a[h+12],20,-1926607734),c=g(c,l,f,d,a[h+5],4,-378558),d=g(d,c,l,f,a[h+8],11,-2022574463),f=g(f,d,c,l,a[h+11],16,1839030562),l=g(l,f,d,c,a[h+14],23,-35309556),c=g(c,l,f,d,a[h+1],4,-1530992060),d=g(d,c,l,f,a[h+4],11,1272893353),f=g(f,d,c,l,a[h+7],16,-155497632),l=g(l,f,d,c,a[h+10],23,-1094730640),c=g(c,l,f,d,a[h+13],4,681279174),d=g(d,c,l,f,a[h+0],11,-358537222),f=g(f,d,c,l,a[h+3],16,-722521979),l=g(l,f,d,c,a[h+6],23,76029189),c=g(c,l,f,d,a[h+9],4,-640364487),d=g(d,c,l,f,a[h+12],11,-421815835),f=g(f,d,c,l,a[h+15],16,530742520),l=g(l,f,d,c,a[h+2],23,-995338651),c=p(c,l,f,d,a[h+0],6,-198630844),d=p(d,c,l,f,a[h+7],10,1126891415),f=p(f,d,c,l,a[h+14],15,-1416354905),l=p(l,f,d,c,a[h+5],21,-57434055),c=p(c,l,f,d,a[h+12],6,1700485571),d=p(d,c,l,f,a[h+3],10,-1894986606),f=p(f,d,c,l,a[h+10],15,-1051523),l=p(l,f,d,c,a[h+1],21,-2054922799),c=p(c,l,f,d,a[h+8],6,1873313359),d=p(d,c,l,f,a[h+15],10,-30611744),f=p(f,d,c,l,a[h+6],15,-1560198380),l=p(l,f,d,c,a[h+13],21,1309151649),c=p(c,l,f,d,a[h+4],6,-145523070),d=p(d,c,l,f,a[h+11],10,-1120210379),f=p(f,d,c,l,a[h+2],15,718787259),l=p(l,f,d,c,a[h+9],21,-343485551),c=c+_>>>0,l=l+N>>>0,f=f+y>>>0,d=d+k>>>0}return t.endian([c,l,f,d])};r._ff=function(o,s,a,u,c,l,f){var d=o+(s&a|~s&u)+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._gg=function(o,s,a,u,c,l,f){var d=o+(s&u|a&~u)+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._hh=function(o,s,a,u,c,l,f){var d=o+(s^a^u)+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._ii=function(o,s,a,u,c,l,f){var d=o+(a^(s|~u))+(c>>>0)+f;return(d<<l|d>>>32-l)+s},r._blocksize=16,r._digestsize=16,Di.exports=function(o,s){if(o==null)throw new Error("Illegal argument "+o);var a=t.wordsToBytes(r(o,s));return s&&s.asBytes?a:s&&s.asString?i.bytesToString(a):t.bytesToHex(a)}})();var Jr=Di.exports;const Ri=Kr(Jr);function Qe(){const t=window.location.href.split("?")[1]||"",e=new URLSearchParams(t),n=new URLSearchParams;return e.has("title ")&&n.set("title",e.get("title")),e.has("size")&&n.set("size",e.get("size")),e.has("superpower")&&n.set("superpower",e.get("superpower")),n}function K(t){var e;return(e=t.kind)==null?void 0:e.trim().split(" + ").reverse()[0]}function Wr(t){var e;return(e=t.kind)==null?void 0:e.split(" + ")[0]}function gt(t){return t.kind.split(" + ").includes("operator")}function Ze(t,e,n=void 0){return e.set("title",n),`/identity/${t}?${e.toString()}`}function Li(t){return t.md5=t.md5||t.identity&&Ri(t.identity)}function Zt(t,e){var I,z,$,O,C,L;if(t.getUrl=()=>{const b=Qe();b.set("superpower","hyperlink");const m=t.md5,S=Ze(m,b,t.identity);return t.url=S,S},t.processed||(t.processed=Date.now(),!t.identity))return t;const n=t.head,i=t.body,r=t.tail;delete t.head,delete t.body,delete t.tail,t.parts={head:n,body:i,tail:r};const o=((I=window.spwashi.values.fx)==null?void 0:I[e])||t.fx||void 0,s=((z=window.spwashi.values.fy)==null?void 0:z[e])||t.fy||void 0,a=(($=window.spwashi.values.r)==null?void 0:$[e])||t.r||window.spwashi.parameters.nodes.radiusMultiplier||void 0,u=((C=(O=window.spwashi.values.text)==null?void 0:O.fontSize)==null?void 0:C[e])||((L=t.text)==null?void 0:L.fontSize)||void 0;t.colorindex=ie(),t.fx=o,t.fy=s,t.r=a,t.collisionRadius=a*2,t.text=t.text||{},t.text.fontSize=u,t.image=t.image||{},t.image.r=100,t.image.offsetX=0,t.image.offsetY=0,Li(t);const c=Qe();t.url=Ze(t.md5,c,t.identity);const l=50,f=window.spwashi.parameters.width-50,d=window.spwashi.parameters.height-50,h=[50,50+d/4,50+d/2,50+3*d/4,d],x="conceptual.close",w="conceptual.open",g="essential.close",p="essential.open",_="structural.open",N="structural.close",y="locational.open",k="locational.close";return[[b=>Wr(b)==="container",{text:{fontSize:10},fx:window.spwashi.parameters.width/2,y:0}],[b=>K(b)==="nominal",{fx:void 0,r:30}],[b=>K(b)==="phrasal",{fx:void 0}],[b=>K(b)==="binding",{fx:100,r:5}],[b=>K(b)==="ordinal",{r:5}],[b=>K(b)===x&&gt(b),{r:10,fx:f,fy:h[0]}],[b=>K(b)===g&&gt(b),{r:10,fx:f,fy:h[1]}],[b=>K(b)===N&&gt(b),{r:10,fx:f,fy:h[2]}],[b=>K(b)===k&&gt(b),{r:10,fx:f,fy:h[3]}],[b=>K(b)===w&&gt(b),{r:10,fx:l,fy:h[0]}],[b=>K(b)===p&&gt(b),{r:10,fx:l,fy:h[1]}],[b=>K(b)===_&&gt(b),{r:10,fx:l,fy:h[2]}],[b=>K(b)===y&&gt(b),{r:10,fx:l,fy:h[3]}]].forEach(([b,m])=>{b(t)&&Object.entries(m).forEach(([S,v])=>{t[S]=v})}),t}const Gt=t=>{window.spwashi.setItem("nodes",window.spwashi.nodes)},Qr=t=>{const n=(window.spwashi.getItem("nodes",window.spwashi.nodes)||[]).find(i=>i.id===t.id);return n||{}},ke=["var(--node-color-0)","var(--node-color-1)","var(--node-color-2)","var(--node-color-3)","var(--node-color-4)","var(--node-color-5)","var(--node-color-6)","var(--node-color-7)","var(--node-color-8)","var(--node-color-9)","var(--node-color-10)","var(--node-color-11)","var(--node-color-12)"],Zr=t=>ke[(t.colorindex||0)%ke.length],tn=t=>t.name,Fi=t=>ke[((t.colorindex||0)+5)%ke.length];function Pn(t,e){let n,i;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(n===void 0?o>=o&&(n=i=o):(n>o&&(n=o),i<o&&(i=o)))}return[n,i]}class Bn extends Map{constructor(e,n=no){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,r]of e)this.set(i,r)}get(e){return super.get(qn(this,e))}has(e){return super.has(qn(this,e))}set(e,n){return super.set(to(this,e),n)}delete(e){return super.delete(eo(this,e))}}function qn({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function to({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function eo({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function no(t){return t!==null&&typeof t=="object"?t.valueOf():t}const io=Math.sqrt(50),ro=Math.sqrt(10),oo=Math.sqrt(2);function be(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),s=o>=io?10:o>=ro?5:o>=oo?2:1;let a,u,c;return r<0?(c=Math.pow(10,-r)/s,a=Math.round(t*c),u=Math.round(e*c),a/c<t&&++a,u/c>e&&--u,c=-c):(c=Math.pow(10,r)*s,a=Math.round(t/c),u=Math.round(e/c),a*c<t&&++a,u*c>e&&--u),u<a&&.5<=n&&n<2?be(t,e,n*2):[a,u,c]}function so(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,o,s]=i?be(e,t,n):be(t,e,n);if(!(o>=r))return[];const a=o-r+1,u=new Array(a);if(i)if(s<0)for(let c=0;c<a;++c)u[c]=(o-c)/-s;else for(let c=0;c<a;++c)u[c]=(o-c)*s;else if(s<0)for(let c=0;c<a;++c)u[c]=(r+c)/-s;else for(let c=0;c<a;++c)u[c]=(r+c)*s;return u}function en(t,e,n){return e=+e,t=+t,n=+n,be(t,e,n)[2]}function ao(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?en(e,t,n):en(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}var co={value:()=>{}};function te(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new we(n)}function we(t){this._=t}function lo(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}we.prototype=te.prototype={constructor:we,on:function(t,e){var n=this._,i=lo(t+"",n),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(t=i[o]).type)&&(r=uo(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(r=(t=i[o]).type)n[r]=Hn(n[r],t.name,e);else if(e==null)for(r in n)n[r]=Hn(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new we(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};function uo(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function Hn(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=co,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var nn="http://www.w3.org/1999/xhtml";const Xn={svg:"http://www.w3.org/2000/svg",xhtml:nn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Oe(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Xn.hasOwnProperty(e)?{space:Xn[e],local:t}:t}function fo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===nn&&e.documentElement.namespaceURI===nn?e.createElement(t):e.createElementNS(n,t)}}function ho(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Pi(t){var e=Oe(t);return(e.local?ho:fo)(e)}function po(){}function gn(t){return t==null?po:function(){return this.querySelector(t)}}function wo(t){typeof t!="function"&&(t=gn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],s=o.length,a=i[r]=new Array(s),u,c,l=0;l<s;++l)(u=o[l])&&(c=t.call(u,u.__data__,l,o))&&("__data__"in u&&(c.__data__=u.__data__),a[l]=c);return new U(i,this._parents)}function mo(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function go(){return[]}function Bi(t){return t==null?go:function(){return this.querySelectorAll(t)}}function yo(t){return function(){return mo(t.apply(this,arguments))}}function xo(t){typeof t=="function"?t=yo(t):t=Bi(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var s=e[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&(i.push(t.call(u,u.__data__,c,s)),r.push(u));return new U(i,r)}function qi(t){return function(){return this.matches(t)}}function Hi(t){return function(e){return e.matches(t)}}var vo=Array.prototype.find;function _o(t){return function(){return vo.call(this.children,t)}}function ko(){return this.firstElementChild}function bo(t){return this.select(t==null?ko:_o(typeof t=="function"?t:Hi(t)))}var So=Array.prototype.filter;function No(){return Array.from(this.children)}function Mo(t){return function(){return So.call(this.children,t)}}function Co(t){return this.selectAll(t==null?No:Mo(typeof t=="function"?t:Hi(t)))}function Eo(t){typeof t!="function"&&(t=qi(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],s=o.length,a=i[r]=[],u,c=0;c<s;++c)(u=o[c])&&t.call(u,u.__data__,c,o)&&a.push(u);return new U(i,this._parents)}function Xi(t){return new Array(t.length)}function To(){return new U(this._enter||this._groups.map(Xi),this._parents)}function Se(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Se.prototype={constructor:Se,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ao(t){return function(){return t}}function Io(t,e,n,i,r,o){for(var s=0,a,u=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new Se(t,o[s]);for(;s<u;++s)(a=e[s])&&(r[s]=a)}function zo(t,e,n,i,r,o,s){var a,u,c=new Map,l=e.length,f=o.length,d=new Array(l),h;for(a=0;a<l;++a)(u=e[a])&&(d[a]=h=s.call(u,u.__data__,a,e)+"",c.has(h)?r[a]=u:c.set(h,u));for(a=0;a<f;++a)h=s.call(t,o[a],a,o)+"",(u=c.get(h))?(i[a]=u,u.__data__=o[a],c.delete(h)):n[a]=new Se(t,o[a]);for(a=0;a<l;++a)(u=e[a])&&c.get(d[a])===u&&(r[a]=u)}function Do(t){return t.__data__}function Oo(t,e){if(!arguments.length)return Array.from(this,Do);var n=e?zo:Io,i=this._parents,r=this._groups;typeof t!="function"&&(t=Ao(t));for(var o=r.length,s=new Array(o),a=new Array(o),u=new Array(o),c=0;c<o;++c){var l=i[c],f=r[c],d=f.length,h=$o(t.call(l,l&&l.__data__,c,i)),x=h.length,w=a[c]=new Array(x),g=s[c]=new Array(x),p=u[c]=new Array(d);n(l,f,w,g,p,h,e);for(var _=0,N=0,y,k;_<x;++_)if(y=w[_]){for(_>=N&&(N=_+1);!(k=g[N])&&++N<x;);y._next=k||null}}return s=new U(s,i),s._enter=a,s._exit=u,s}function $o(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ro(){return new U(this._exit||this._groups.map(Xi),this._parents)}function Lo(t,e,n){var i=this.enter(),r=this,o=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function Fo(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),u=0;u<s;++u)for(var c=n[u],l=i[u],f=c.length,d=a[u]=new Array(f),h,x=0;x<f;++x)(h=c[x]||l[x])&&(d[x]=h);for(;u<r;++u)a[u]=n[u];return new U(a,this._parents)}function Po(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Bo(t){t||(t=qo);function e(f,d){return f&&d?t(f.__data__,d.__data__):!f-!d}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s=n[o],a=s.length,u=r[o]=new Array(a),c,l=0;l<a;++l)(c=s[l])&&(u[l]=c);u.sort(e)}return new U(r,this._parents).order()}function qo(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ho(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Xo(){return Array.from(this)}function Yo(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function Uo(){let t=0;for(const e of this)++t;return t}function Ko(){return!this.node()}function Go(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],o=0,s=r.length,a;o<s;++o)(a=r[o])&&t.call(a,a.__data__,o,r);return this}function Vo(t){return function(){this.removeAttribute(t)}}function jo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Jo(t,e){return function(){this.setAttribute(t,e)}}function Wo(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Qo(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Zo(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function ts(t,e){var n=Oe(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?jo:Vo:typeof e=="function"?n.local?Zo:Qo:n.local?Wo:Jo)(n,e))}function Yi(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function es(t){return function(){this.style.removeProperty(t)}}function ns(t,e,n){return function(){this.style.setProperty(t,e,n)}}function is(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function rs(t,e,n){return arguments.length>1?this.each((e==null?es:typeof e=="function"?is:ns)(t,e,n??"")):Pt(this.node(),t)}function Pt(t,e){return t.style.getPropertyValue(e)||Yi(t).getComputedStyle(t,null).getPropertyValue(e)}function os(t){return function(){delete this[t]}}function ss(t,e){return function(){this[t]=e}}function as(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function cs(t,e){return arguments.length>1?this.each((e==null?os:typeof e=="function"?as:ss)(t,e)):this.node()[t]}function Ui(t){return t.trim().split(/^|\s+/)}function yn(t){return t.classList||new Ki(t)}function Ki(t){this._node=t,this._names=Ui(t.getAttribute("class")||"")}Ki.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Gi(t,e){for(var n=yn(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Vi(t,e){for(var n=yn(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function ls(t){return function(){Gi(this,t)}}function us(t){return function(){Vi(this,t)}}function fs(t,e){return function(){(e.apply(this,arguments)?Gi:Vi)(this,t)}}function ds(t,e){var n=Ui(t+"");if(arguments.length<2){for(var i=yn(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?fs:e?ls:us)(n,e))}function hs(){this.textContent=""}function ps(t){return function(){this.textContent=t}}function ws(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ms(t){return arguments.length?this.each(t==null?hs:(typeof t=="function"?ws:ps)(t)):this.node().textContent}function gs(){this.innerHTML=""}function ys(t){return function(){this.innerHTML=t}}function xs(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function vs(t){return arguments.length?this.each(t==null?gs:(typeof t=="function"?xs:ys)(t)):this.node().innerHTML}function _s(){this.nextSibling&&this.parentNode.appendChild(this)}function ks(){return this.each(_s)}function bs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ss(){return this.each(bs)}function Ns(t){var e=typeof t=="function"?t:Pi(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ms(){return null}function Cs(t,e){var n=typeof t=="function"?t:Pi(t),i=e==null?Ms:typeof e=="function"?e:gn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Es(){var t=this.parentNode;t&&t.removeChild(this)}function Ts(){return this.each(Es)}function As(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Is(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function zs(t){return this.select(t?Is:As)}function Ds(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Os(t){return function(e){t.call(this,e,this.__data__)}}function $s(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Rs(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,o;n<r;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++i]=o;++i?e.length=i:delete this.__on}}}function Ls(t,e,n){return function(){var i=this.__on,r,o=Os(e);if(i){for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=e;return}}this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function Fs(t,e,n){var i=$s(t+""),r,o=i.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,c=a.length,l;u<c;++u)for(r=0,l=a[u];r<o;++r)if((s=i[r]).type===l.type&&s.name===l.name)return l.value}return}for(a=e?Ls:Rs,r=0;r<o;++r)this.each(a(i[r],e,n));return this}function ji(t,e,n){var i=Yi(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Ps(t,e){return function(){return ji(this,t,e)}}function Bs(t,e){return function(){return ji(this,t,e.apply(this,arguments))}}function qs(t,e){return this.each((typeof e=="function"?Bs:Ps)(t,e))}function*Hs(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var Ji=[null];function U(t,e){this._groups=t,this._parents=e}function ee(){return new U([[document.documentElement]],Ji)}function Xs(){return this}U.prototype=ee.prototype={constructor:U,select:wo,selectAll:xo,selectChild:bo,selectChildren:Co,filter:Eo,data:Oo,enter:To,exit:Ro,join:Lo,merge:Fo,selection:Xs,order:Po,sort:Bo,call:Ho,nodes:Xo,node:Yo,size:Uo,empty:Ko,each:Go,attr:ts,style:rs,property:cs,classed:ds,text:ms,html:vs,raise:ks,lower:Ss,append:Ns,insert:Cs,remove:Ts,clone:zs,datum:Ds,on:Fs,dispatch:qs,[Symbol.iterator]:Hs};function st(t){return typeof t=="string"?new U([[document.querySelector(t)]],[document.documentElement]):new U([[t]],Ji)}function Ys(t){let e;for(;e=t.sourceEvent;)t=e;return t}function dt(t,e){if(t=Ys(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const Us={passive:!1},Vt={capture:!0,passive:!1};function Xe(t){t.stopImmediatePropagation()}function $t(t){t.preventDefault(),t.stopImmediatePropagation()}function Wi(t){var e=t.document.documentElement,n=st(t).on("dragstart.drag",$t,Vt);"onselectstart"in e?n.on("selectstart.drag",$t,Vt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Qi(t,e){var n=t.document.documentElement,i=st(t).on("dragstart.drag",null);e&&(i.on("click.drag",$t,Vt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const se=t=>()=>t;function rn(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:o,x:s,y:a,dx:u,dy:c,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:l}})}rn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Ks(t){return!t.ctrlKey&&!t.button}function Gs(){return this.parentNode}function Vs(t,e){return e??{x:t.x,y:t.y}}function js(){return navigator.maxTouchPoints||"ontouchstart"in this}function $e(){var t=Ks,e=Gs,n=Vs,i=js,r={},o=te("start","drag","end"),s=0,a,u,c,l,f=0;function d(y){y.on("mousedown.drag",h).filter(i).on("touchstart.drag",g).on("touchmove.drag",p,Us).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(y,k){if(!(l||!t.call(this,y,k))){var T=N(this,e.call(this,y,k),y,k,"mouse");T&&(st(y.view).on("mousemove.drag",x,Vt).on("mouseup.drag",w,Vt),Wi(y.view),Xe(y),c=!1,a=y.clientX,u=y.clientY,T("start",y))}}function x(y){if($t(y),!c){var k=y.clientX-a,T=y.clientY-u;c=k*k+T*T>f}r.mouse("drag",y)}function w(y){st(y.view).on("mousemove.drag mouseup.drag",null),Qi(y.view,c),$t(y),r.mouse("end",y)}function g(y,k){if(t.call(this,y,k)){var T=y.changedTouches,I=e.call(this,y,k),z=T.length,$,O;for($=0;$<z;++$)(O=N(this,I,y,k,T[$].identifier,T[$]))&&(Xe(y),O("start",y,T[$]))}}function p(y){var k=y.changedTouches,T=k.length,I,z;for(I=0;I<T;++I)(z=r[k[I].identifier])&&($t(y),z("drag",y,k[I]))}function _(y){var k=y.changedTouches,T=k.length,I,z;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),I=0;I<T;++I)(z=r[k[I].identifier])&&(Xe(y),z("end",y,k[I]))}function N(y,k,T,I,z,$){var O=o.copy(),C=dt($||T,k),L,b,m;if((m=n.call(y,new rn("beforestart",{sourceEvent:T,target:d,identifier:z,active:s,x:C[0],y:C[1],dx:0,dy:0,dispatch:O}),I))!=null)return L=m.x-C[0]||0,b=m.y-C[1]||0,function S(v,M,A){var E=C,D;switch(v){case"start":r[z]=S,D=s++;break;case"end":delete r[z],--s;case"drag":C=dt(A||M,k),D=s;break}O.call(v,y,new rn(v,{sourceEvent:M,subject:m,target:d,identifier:z,active:D,x:C[0]+L,y:C[1]+b,dx:C[0]-E[0],dy:C[1]-E[1],dispatch:O}),I)}}return d.filter=function(y){return arguments.length?(t=typeof y=="function"?y:se(!!y),d):t},d.container=function(y){return arguments.length?(e=typeof y=="function"?y:se(y),d):e},d.subject=function(y){return arguments.length?(n=typeof y=="function"?y:se(y),d):n},d.touchable=function(y){return arguments.length?(i=typeof y=="function"?y:se(!!y),d):i},d.on=function(){var y=o.on.apply(o,arguments);return y===o?d:y},d.clickDistance=function(y){return arguments.length?(f=(y=+y)*y,d):Math.sqrt(f)},d}function xn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Zi(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function ne(){}var jt=.7,Ne=1/jt,Rt="\\s*([+-]?\\d+)\\s*",Jt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",at="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Js=/^#([0-9a-f]{3,8})$/,Ws=new RegExp(`^rgb\\(${Rt},${Rt},${Rt}\\)$`),Qs=new RegExp(`^rgb\\(${at},${at},${at}\\)$`),Zs=new RegExp(`^rgba\\(${Rt},${Rt},${Rt},${Jt}\\)$`),ta=new RegExp(`^rgba\\(${at},${at},${at},${Jt}\\)$`),ea=new RegExp(`^hsl\\(${Jt},${at},${at}\\)$`),na=new RegExp(`^hsla\\(${Jt},${at},${at},${Jt}\\)$`),Yn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xn(ne,Et,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Un,formatHex:Un,formatHex8:ia,formatHsl:ra,formatRgb:Kn,toString:Kn});function Un(){return this.rgb().formatHex()}function ia(){return this.rgb().formatHex8()}function ra(){return tr(this).formatHsl()}function Kn(){return this.rgb().formatRgb()}function Et(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Js.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Gn(e):n===3?new Y(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ae(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ae(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ws.exec(t))?new Y(e[1],e[2],e[3],1):(e=Qs.exec(t))?new Y(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Zs.exec(t))?ae(e[1],e[2],e[3],e[4]):(e=ta.exec(t))?ae(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ea.exec(t))?Jn(e[1],e[2]/100,e[3]/100,1):(e=na.exec(t))?Jn(e[1],e[2]/100,e[3]/100,e[4]):Yn.hasOwnProperty(t)?Gn(Yn[t]):t==="transparent"?new Y(NaN,NaN,NaN,0):null}function Gn(t){return new Y(t>>16&255,t>>8&255,t&255,1)}function ae(t,e,n,i){return i<=0&&(t=e=n=NaN),new Y(t,e,n,i)}function oa(t){return t instanceof ne||(t=Et(t)),t?(t=t.rgb(),new Y(t.r,t.g,t.b,t.opacity)):new Y}function on(t,e,n,i){return arguments.length===1?oa(t):new Y(t,e,n,i??1)}function Y(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}xn(Y,on,Zi(ne,{brighter(t){return t=t==null?Ne:Math.pow(Ne,t),new Y(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?jt:Math.pow(jt,t),new Y(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Y(Nt(this.r),Nt(this.g),Nt(this.b),Me(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Vn,formatHex:Vn,formatHex8:sa,formatRgb:jn,toString:jn}));function Vn(){return`#${St(this.r)}${St(this.g)}${St(this.b)}`}function sa(){return`#${St(this.r)}${St(this.g)}${St(this.b)}${St((isNaN(this.opacity)?1:this.opacity)*255)}`}function jn(){const t=Me(this.opacity);return`${t===1?"rgb(":"rgba("}${Nt(this.r)}, ${Nt(this.g)}, ${Nt(this.b)}${t===1?")":`, ${t})`}`}function Me(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Nt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function St(t){return t=Nt(t),(t<16?"0":"")+t.toString(16)}function Jn(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Z(t,e,n,i)}function tr(t){if(t instanceof Z)return new Z(t.h,t.s,t.l,t.opacity);if(t instanceof ne||(t=Et(t)),!t)return new Z;if(t instanceof Z)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,u=(o+r)/2;return a?(e===o?s=(n-i)/a+(n<i)*6:n===o?s=(i-e)/a+2:s=(e-n)/a+4,a/=u<.5?o+r:2-o-r,s*=60):a=u>0&&u<1?0:s,new Z(s,a,u,t.opacity)}function aa(t,e,n,i){return arguments.length===1?tr(t):new Z(t,e,n,i??1)}function Z(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}xn(Z,aa,Zi(ne,{brighter(t){return t=t==null?Ne:Math.pow(Ne,t),new Z(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?jt:Math.pow(jt,t),new Z(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Y(Ye(t>=240?t-240:t+120,r,i),Ye(t,r,i),Ye(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Z(Wn(this.h),ce(this.s),ce(this.l),Me(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Me(this.opacity);return`${t===1?"hsl(":"hsla("}${Wn(this.h)}, ${ce(this.s)*100}%, ${ce(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Wn(t){return t=(t||0)%360,t<0?t+360:t}function ce(t){return Math.max(0,Math.min(1,t||0))}function Ye(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const vn=t=>()=>t;function ca(t,e){return function(n){return t+n*e}}function la(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function ua(t){return(t=+t)==1?er:function(e,n){return n-e?la(e,n,t):vn(isNaN(e)?n:e)}}function er(t,e){var n=e-t;return n?ca(t,n):vn(isNaN(t)?e:t)}const Ce=function t(e){var n=ua(e);function i(r,o){var s=n((r=on(r)).r,(o=on(o)).r),a=n(r.g,o.g),u=n(r.b,o.b),c=er(r.opacity,o.opacity);return function(l){return r.r=s(l),r.g=a(l),r.b=u(l),r.opacity=c(l),r+""}}return i.gamma=t,i}(1);function fa(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function da(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ha(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),o=new Array(n),s;for(s=0;s<i;++s)r[s]=_n(t[s],e[s]);for(;s<n;++s)o[s]=e[s];return function(a){for(s=0;s<i;++s)o[s]=r[s](a);return o}}function pa(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function ot(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function wa(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=_n(t[r],e[r]):i[r]=e[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var sn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ue=new RegExp(sn.source,"g");function ma(t){return function(){return t}}function ga(t){return function(e){return t(e)+""}}function nr(t,e){var n=sn.lastIndex=Ue.lastIndex=0,i,r,o,s=-1,a=[],u=[];for(t=t+"",e=e+"";(i=sn.exec(t))&&(r=Ue.exec(e));)(o=r.index)>n&&(o=e.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(i=i[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:ot(i,r)})),n=Ue.lastIndex;return n<e.length&&(o=e.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?ga(u[0].x):ma(e):(e=u.length,function(c){for(var l=0,f;l<e;++l)a[(f=u[l]).i]=f.x(c);return a.join("")})}function _n(t,e){var n=typeof e,i;return e==null||n==="boolean"?vn(e):(n==="number"?ot:n==="string"?(i=Et(e))?(e=i,Ce):nr:e instanceof Et?Ce:e instanceof Date?pa:da(e)?fa:Array.isArray(e)?ha:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?wa:ot)(t,e)}function ya(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Qn=180/Math.PI,an={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ir(t,e,n,i,r,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*i)&&(n-=t*u,i-=e*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),t*i<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*Qn,skewX:Math.atan(u)*Qn,scaleX:s,scaleY:a}}var le;function xa(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?an:ir(e.a,e.b,e.c,e.d,e.e,e.f)}function va(t){return t==null||(le||(le=document.createElementNS("http://www.w3.org/2000/svg","g")),le.setAttribute("transform",t),!(t=le.transform.baseVal.consolidate()))?an:(t=t.matrix,ir(t.a,t.b,t.c,t.d,t.e,t.f))}function rr(t,e,n,i){function r(c){return c.length?c.pop()+" ":""}function o(c,l,f,d,h,x){if(c!==f||l!==d){var w=h.push("translate(",null,e,null,n);x.push({i:w-4,x:ot(c,f)},{i:w-2,x:ot(l,d)})}else(f||d)&&h.push("translate("+f+e+d+n)}function s(c,l,f,d){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:ot(c,l)})):l&&f.push(r(f)+"rotate("+l+i)}function a(c,l,f,d){c!==l?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:ot(c,l)}):l&&f.push(r(f)+"skewX("+l+i)}function u(c,l,f,d,h,x){if(c!==f||l!==d){var w=h.push(r(h)+"scale(",null,",",null,")");x.push({i:w-4,x:ot(c,f)},{i:w-2,x:ot(l,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(c,l){var f=[],d=[];return c=t(c),l=t(l),o(c.translateX,c.translateY,l.translateX,l.translateY,f,d),s(c.rotate,l.rotate,f,d),a(c.skewX,l.skewX,f,d),u(c.scaleX,c.scaleY,l.scaleX,l.scaleY,f,d),c=l=null,function(h){for(var x=-1,w=d.length,g;++x<w;)f[(g=d[x]).i]=g.x(h);return f.join("")}}}var _a=rr(xa,"px, ","px)","deg)"),ka=rr(va,", ",")",")"),ba=1e-12;function Zn(t){return((t=Math.exp(t))+1/t)/2}function Sa(t){return((t=Math.exp(t))-1/t)/2}function Na(t){return((t=Math.exp(2*t))-1)/(t+1)}const Ma=function t(e,n,i){function r(o,s){var a=o[0],u=o[1],c=o[2],l=s[0],f=s[1],d=s[2],h=l-a,x=f-u,w=h*h+x*x,g,p;if(w<ba)p=Math.log(d/c)/e,g=function(I){return[a+I*h,u+I*x,c*Math.exp(e*I*p)]};else{var _=Math.sqrt(w),N=(d*d-c*c+i*w)/(2*c*n*_),y=(d*d-c*c-i*w)/(2*d*n*_),k=Math.log(Math.sqrt(N*N+1)-N),T=Math.log(Math.sqrt(y*y+1)-y);p=(T-k)/e,g=function(I){var z=I*p,$=Zn(k),O=c/(n*_)*($*Na(e*z+k)-Sa(k));return[a+O*h,u+O*x,c*$/Zn(e*z+k)]}}return g.duration=p*1e3*e/Math.SQRT2,g}return r.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return t(s,a,u)},r}(Math.SQRT2,2,4);var Bt=0,Yt=0,Ht=0,or=1e3,Ee,Ut,Te=0,Tt=0,Re=0,Wt=typeof performance=="object"&&performance.now?performance:Date,sr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function kn(){return Tt||(sr(Ca),Tt=Wt.now()+Re)}function Ca(){Tt=0}function Ae(){this._call=this._time=this._next=null}Ae.prototype=bn.prototype={constructor:Ae,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?kn():+n)+(e==null?0:+e),!this._next&&Ut!==this&&(Ut?Ut._next=this:Ee=this,Ut=this),this._call=t,this._time=n,cn()},stop:function(){this._call&&(this._call=null,this._time=1/0,cn())}};function bn(t,e,n){var i=new Ae;return i.restart(t,e,n),i}function Ea(){kn(),++Bt;for(var t=Ee,e;t;)(e=Tt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Bt}function ti(){Tt=(Te=Wt.now())+Re,Bt=Yt=0;try{Ea()}finally{Bt=0,Aa(),Tt=0}}function Ta(){var t=Wt.now(),e=t-Te;e>or&&(Re-=e,Te=t)}function Aa(){for(var t,e=Ee,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ee=n);Ut=t,cn(i)}function cn(t){if(!Bt){Yt&&(Yt=clearTimeout(Yt));var e=t-Tt;e>24?(t<1/0&&(Yt=setTimeout(ti,t-Wt.now()-Re)),Ht&&(Ht=clearInterval(Ht))):(Ht||(Te=Wt.now(),Ht=setInterval(Ta,or)),Bt=1,sr(ti))}}function ei(t,e,n){var i=new Ae;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var Ia=te("start","end","cancel","interrupt"),za=[],ar=0,ni=1,ln=2,me=3,ii=4,un=5,ge=6;function Le(t,e,n,i,r,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Da(t,n,{name:e,index:i,group:r,on:Ia,tween:za,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ar})}function Sn(t,e){var n=nt(t,e);if(n.state>ar)throw new Error("too late; already scheduled");return n}function ct(t,e){var n=nt(t,e);if(n.state>me)throw new Error("too late; already running");return n}function nt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Da(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=bn(o,0,n.time);function o(c){n.state=ni,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var l,f,d,h;if(n.state!==ni)return u();for(l in i)if(h=i[l],h.name===n.name){if(h.state===me)return ei(s);h.state===ii?(h.state=ge,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[l]):+l<e&&(h.state=ge,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[l])}if(ei(function(){n.state===me&&(n.state=ii,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=ln,n.on.call("start",t,t.__data__,n.index,n.group),n.state===ln){for(n.state=me,r=new Array(d=n.tween.length),l=0,f=-1;l<d;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=h);r.length=f+1}}function a(c){for(var l=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=un,1),f=-1,d=r.length;++f<d;)r[f].call(t,l);n.state===un&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=ge,n.timer.stop(),delete i[e];for(var c in i)return;delete t.__transition}}function ye(t,e){var n=t.__transition,i,r,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((i=n[s]).name!==e){o=!1;continue}r=i.state>ln&&i.state<un,i.state=ge,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[s]}o&&delete t.__transition}}function Oa(t){return this.each(function(){ye(this,t)})}function $a(t,e){var n,i;return function(){var r=ct(this,t),o=r.tween;if(o!==n){i=n=o;for(var s=0,a=i.length;s<a;++s)if(i[s].name===e){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function Ra(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=ct(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:e,value:n},u=0,c=r.length;u<c;++u)if(r[u].name===e){r[u]=a;break}u===c&&r.push(a)}o.tween=r}}function La(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=nt(this.node(),n).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===t)return s.value;return null}return this.each((e==null?$a:Ra)(n,t,e))}function Nn(t,e,n){var i=t._id;return t.each(function(){var r=ct(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return nt(r,i).value[e]}}function cr(t,e){var n;return(typeof e=="number"?ot:e instanceof Et?Ce:(n=Et(e))?(e=n,Ce):nr)(t,e)}function Fa(t){return function(){this.removeAttribute(t)}}function Pa(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ba(t,e,n){var i,r=n+"",o;return function(){var s=this.getAttribute(t);return s===r?null:s===i?o:o=e(i=s,n)}}function qa(t,e,n){var i,r=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?o:o=e(i=s,n)}}function Ha(t,e,n){var i,r,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),u=a+"",s===u?null:s===i&&u===r?o:(r=u,o=e(i=s,a)))}}function Xa(t,e,n){var i,r,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),u=a+"",s===u?null:s===i&&u===r?o:(r=u,o=e(i=s,a)))}}function Ya(t,e){var n=Oe(t),i=n==="transform"?ka:cr;return this.attrTween(t,typeof e=="function"?(n.local?Xa:Ha)(n,i,Nn(this,"attr."+t,e)):e==null?(n.local?Pa:Fa)(n):(n.local?qa:Ba)(n,i,e))}function Ua(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ka(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ga(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&Ka(t,o)),n}return r._value=e,r}function Va(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&Ua(t,o)),n}return r._value=e,r}function ja(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=Oe(t);return this.tween(n,(i.local?Ga:Va)(i,e))}function Ja(t,e){return function(){Sn(this,t).delay=+e.apply(this,arguments)}}function Wa(t,e){return e=+e,function(){Sn(this,t).delay=e}}function Qa(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ja:Wa)(e,t)):nt(this.node(),e).delay}function Za(t,e){return function(){ct(this,t).duration=+e.apply(this,arguments)}}function tc(t,e){return e=+e,function(){ct(this,t).duration=e}}function ec(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Za:tc)(e,t)):nt(this.node(),e).duration}function nc(t,e){if(typeof e!="function")throw new Error;return function(){ct(this,t).ease=e}}function ic(t){var e=this._id;return arguments.length?this.each(nc(e,t)):nt(this.node(),e).ease}function rc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ct(this,t).ease=n}}function oc(t){if(typeof t!="function")throw new Error;return this.each(rc(this._id,t))}function sc(t){typeof t!="function"&&(t=qi(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],s=o.length,a=i[r]=[],u,c=0;c<s;++c)(u=o[c])&&t.call(u,u.__data__,c,o)&&a.push(u);return new mt(i,this._parents,this._name,this._id)}function ac(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var u=e[a],c=n[a],l=u.length,f=s[a]=new Array(l),d,h=0;h<l;++h)(d=u[h]||c[h])&&(f[h]=d);for(;a<i;++a)s[a]=e[a];return new mt(s,this._parents,this._name,this._id)}function cc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function lc(t,e,n){var i,r,o=cc(e)?Sn:ct;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(e,n),s.on=r}}function uc(t,e){var n=this._id;return arguments.length<2?nt(this.node(),n).on.on(t):this.each(lc(n,t,e))}function fc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function dc(){return this.on("end.remove",fc(this._id))}function hc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=gn(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a=i[s],u=a.length,c=o[s]=new Array(u),l,f,d=0;d<u;++d)(l=a[d])&&(f=t.call(l,l.__data__,d,a))&&("__data__"in l&&(f.__data__=l.__data__),c[d]=f,Le(c[d],e,n,d,c,nt(l,n)));return new mt(o,this._parents,e,n)}function pc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Bi(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var u=i[a],c=u.length,l,f=0;f<c;++f)if(l=u[f]){for(var d=t.call(l,l.__data__,f,u),h,x=nt(l,n),w=0,g=d.length;w<g;++w)(h=d[w])&&Le(h,e,n,w,d,x);o.push(d),s.push(l)}return new mt(o,s,e,n)}var wc=ee.prototype.constructor;function mc(){return new wc(this._groups,this._parents)}function gc(t,e){var n,i,r;return function(){var o=Pt(this,t),s=(this.style.removeProperty(t),Pt(this,t));return o===s?null:o===n&&s===i?r:r=e(n=o,i=s)}}function lr(t){return function(){this.style.removeProperty(t)}}function yc(t,e,n){var i,r=n+"",o;return function(){var s=Pt(this,t);return s===r?null:s===i?o:o=e(i=s,n)}}function xc(t,e,n){var i,r,o;return function(){var s=Pt(this,t),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(t),Pt(this,t))),s===u?null:s===i&&u===r?o:(r=u,o=e(i=s,a))}}function vc(t,e){var n,i,r,o="style."+e,s="end."+o,a;return function(){var u=ct(this,t),c=u.on,l=u.value[o]==null?a||(a=lr(e)):void 0;(c!==n||r!==l)&&(i=(n=c).copy()).on(s,r=l),u.on=i}}function _c(t,e,n){var i=(t+="")=="transform"?_a:cr;return e==null?this.styleTween(t,gc(t,i)).on("end.style."+t,lr(t)):typeof e=="function"?this.styleTween(t,xc(t,i,Nn(this,"style."+t,e))).each(vc(this._id,t)):this.styleTween(t,yc(t,i,e),n).on("end.style."+t,null)}function kc(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function bc(t,e,n){var i,r;function o(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&kc(t,s,n)),i}return o._value=e,o}function Sc(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,bc(t,e,n??""))}function Nc(t){return function(){this.textContent=t}}function Mc(t){return function(){var e=t(this);this.textContent=e??""}}function Cc(t){return this.tween("text",typeof t=="function"?Mc(Nn(this,"text",t)):Nc(t==null?"":t+""))}function Ec(t){return function(e){this.textContent=t.call(this,e)}}function Tc(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Ec(r)),e}return i._value=t,i}function Ac(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Tc(t))}function Ic(){for(var t=this._name,e=this._id,n=ur(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,u,c=0;c<a;++c)if(u=s[c]){var l=nt(u,e);Le(u,t,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new mt(i,this._parents,t,n)}function zc(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var a={value:s},u={value:function(){--r===0&&o()}};n.each(function(){var c=ct(this,i),l=c.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),c.on=e}),r===0&&o()})}var Dc=0;function mt(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function ur(){return++Dc}var ft=ee.prototype;mt.prototype={constructor:mt,select:hc,selectAll:pc,selectChild:ft.selectChild,selectChildren:ft.selectChildren,filter:sc,merge:ac,selection:mc,transition:Ic,call:ft.call,nodes:ft.nodes,node:ft.node,size:ft.size,empty:ft.empty,each:ft.each,on:uc,attr:Ya,attrTween:ja,style:_c,styleTween:Sc,text:Cc,textTween:Ac,remove:dc,tween:La,delay:Qa,duration:ec,ease:ic,easeVarying:oc,end:zc,[Symbol.iterator]:ft[Symbol.iterator]};function Oc(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var $c={time:null,delay:0,duration:250,ease:Oc};function Rc(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Lc(t){var e,n;t instanceof mt?(e=t._id,t=t._name):(e=ur(),(n=$c).time=kn(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&Le(u,t,e,c,s,n||Rc(u,e));return new mt(i,this._parents,t,e)}ee.prototype.interrupt=Oa;ee.prototype.transition=Lc;function Fc(t,e){var n,i=1;t==null&&(t=0),e==null&&(e=0);function r(){var o,s=n.length,a,u=0,c=0;for(o=0;o<s;++o)a=n[o],u+=a.x,c+=a.y;for(u=(u/s-t)*i,c=(c/s-e)*i,o=0;o<s;++o)a=n[o],a.x-=u,a.y-=c}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(t=+o,r):t},r.y=function(o){return arguments.length?(e=+o,r):e},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function Pc(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return fr(this.cover(e,n),e,n,t)}function fr(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o=t._root,s={data:i},a=t._x0,u=t._y0,c=t._x1,l=t._y1,f,d,h,x,w,g,p,_;if(!o)return t._root=s,t;for(;o.length;)if((w=e>=(f=(a+c)/2))?a=f:c=f,(g=n>=(d=(u+l)/2))?u=d:l=d,r=o,!(o=o[p=g<<1|w]))return r[p]=s,t;if(h=+t._x.call(null,o.data),x=+t._y.call(null,o.data),e===h&&n===x)return s.next=o,r?r[p]=s:t._root=s,t;do r=r?r[p]=new Array(4):t._root=new Array(4),(w=e>=(f=(a+c)/2))?a=f:c=f,(g=n>=(d=(u+l)/2))?u=d:l=d;while((p=g<<1|w)===(_=(x>=d)<<1|h>=f));return r[_]=o,r[p]=s,t}function Bc(t){var e,n,i=t.length,r,o,s=new Array(i),a=new Array(i),u=1/0,c=1/0,l=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(s[n]=r,a[n]=o,r<u&&(u=r),r>l&&(l=r),o<c&&(c=o),o>f&&(f=o));if(u>l||c>f)return this;for(this.cover(u,c).cover(l,f),n=0;n<i;++n)fr(this,s[n],a[n],t[n]);return this}function qc(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{for(var s=r-n||1,a=this._root,u,c;n>t||t>=r||i>e||e>=o;)switch(c=(e<i)<<1|t<n,u=new Array(4),u[c]=a,a=u,s*=2,c){case 0:r=n+s,o=i+s;break;case 1:n=r-s,o=i+s;break;case 2:r=n+s,i=o-s;break;case 3:n=r-s,i=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function Hc(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Xc(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function H(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function Yc(t,e,n){var i,r=this._x0,o=this._y0,s,a,u,c,l=this._x1,f=this._y1,d=[],h=this._root,x,w;for(h&&d.push(new H(h,r,o,l,f)),n==null?n=1/0:(r=t-n,o=e-n,l=t+n,f=e+n,n*=n);x=d.pop();)if(!(!(h=x.node)||(s=x.x0)>l||(a=x.y0)>f||(u=x.x1)<r||(c=x.y1)<o))if(h.length){var g=(s+u)/2,p=(a+c)/2;d.push(new H(h[3],g,p,u,c),new H(h[2],s,p,g,c),new H(h[1],g,a,u,p),new H(h[0],s,a,g,p)),(w=(e>=p)<<1|t>=g)&&(x=d[d.length-1],d[d.length-1]=d[d.length-1-w],d[d.length-1-w]=x)}else{var _=t-+this._x.call(null,h.data),N=e-+this._y.call(null,h.data),y=_*_+N*N;if(y<n){var k=Math.sqrt(n=y);r=t-k,o=e-k,l=t+k,f=e+k,i=h.data}}return i}function Uc(t){if(isNaN(l=+this._x.call(null,t))||isNaN(f=+this._y.call(null,t)))return this;var e,n=this._root,i,r,o,s=this._x0,a=this._y0,u=this._x1,c=this._y1,l,f,d,h,x,w,g,p;if(!n)return this;if(n.length)for(;;){if((x=l>=(d=(s+u)/2))?s=d:u=d,(w=f>=(h=(a+c)/2))?a=h:c=h,e=n,!(n=n[g=w<<1|x]))return this;if(!n.length)break;(e[g+1&3]||e[g+2&3]||e[g+3&3])&&(i=e,p=g)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):e?(o?e[g]=o:delete e[g],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[p]=n:this._root=n),this):(this._root=o,this)}function Kc(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Gc(){return this._root}function Vc(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function jc(t){var e=[],n,i=this._root,r,o,s,a,u;for(i&&e.push(new H(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&i.length){var c=(o+a)/2,l=(s+u)/2;(r=i[3])&&e.push(new H(r,c,l,a,u)),(r=i[2])&&e.push(new H(r,o,l,c,u)),(r=i[1])&&e.push(new H(r,c,s,a,l)),(r=i[0])&&e.push(new H(r,o,s,c,l))}return this}function Jc(t){var e=[],n=[],i;for(this._root&&e.push(new H(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var o,s=i.x0,a=i.y0,u=i.x1,c=i.y1,l=(s+u)/2,f=(a+c)/2;(o=r[0])&&e.push(new H(o,s,a,l,f)),(o=r[1])&&e.push(new H(o,l,a,u,f)),(o=r[2])&&e.push(new H(o,s,f,l,c)),(o=r[3])&&e.push(new H(o,l,f,u,c))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Wc(t){return t[0]}function Qc(t){return arguments.length?(this._x=t,this):this._x}function Zc(t){return t[1]}function tl(t){return arguments.length?(this._y=t,this):this._y}function Mn(t,e,n){var i=new Cn(e??Wc,n??Zc,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function Cn(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function ri(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var X=Mn.prototype=Cn.prototype;X.copy=function(){var t=new Cn(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=ri(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=ri(i));return t};X.add=Pc;X.addAll=Bc;X.cover=qc;X.data=Hc;X.extent=Xc;X.find=Yc;X.remove=Uc;X.removeAll=Kc;X.root=Gc;X.size=Vc;X.visit=jc;X.visitAfter=Jc;X.x=Qc;X.y=tl;function Mt(t){return function(){return t}}function vt(t){return(t()-.5)*1e-6}function el(t){return t.x+t.vx}function nl(t){return t.y+t.vy}function il(t){var e,n,i,r=1,o=1;typeof t!="function"&&(t=Mt(t==null?1:+t));function s(){for(var c,l=e.length,f,d,h,x,w,g,p=0;p<o;++p)for(f=Mn(e,el,nl).visitAfter(a),c=0;c<l;++c)d=e[c],w=n[d.index],g=w*w,h=d.x+d.vx,x=d.y+d.vy,f.visit(_);function _(N,y,k,T,I){var z=N.data,$=N.r,O=w+$;if(z){if(z.index>d.index){var C=h-z.x-z.vx,L=x-z.y-z.vy,b=C*C+L*L;b<O*O&&(C===0&&(C=vt(i),b+=C*C),L===0&&(L=vt(i),b+=L*L),b=(O-(b=Math.sqrt(b)))/b*r,d.vx+=(C*=b)*(O=($*=$)/(g+$)),d.vy+=(L*=b)*O,z.vx-=C*(O=1-O),z.vy-=L*O)}return}return y>h+O||T<h-O||k>x+O||I<x-O}}function a(c){if(c.data)return c.r=n[c.data.index];for(var l=c.r=0;l<4;++l)c[l]&&c[l].r>c.r&&(c.r=c[l].r)}function u(){if(e){var c,l=e.length,f;for(n=new Array(l),c=0;c<l;++c)f=e[c],n[f.index]=+t(f,c,e)}}return s.initialize=function(c,l){e=c,i=l,u()},s.iterations=function(c){return arguments.length?(o=+c,s):o},s.strength=function(c){return arguments.length?(r=+c,s):r},s.radius=function(c){return arguments.length?(t=typeof c=="function"?c:Mt(+c),u(),s):t},s}function rl(t){return t.index}function oi(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function ol(t){var e=rl,n=f,i,r=Mt(30),o,s,a,u,c,l=1;t==null&&(t=[]);function f(g){return 1/Math.min(a[g.source.index],a[g.target.index])}function d(g){for(var p=0,_=t.length;p<l;++p)for(var N=0,y,k,T,I,z,$,O;N<_;++N)y=t[N],k=y.source,T=y.target,I=T.x+T.vx-k.x-k.vx||vt(c),z=T.y+T.vy-k.y-k.vy||vt(c),$=Math.sqrt(I*I+z*z),$=($-o[N])/$*g*i[N],I*=$,z*=$,T.vx-=I*(O=u[N]),T.vy-=z*O,k.vx+=I*(O=1-O),k.vy+=z*O}function h(){if(s){var g,p=s.length,_=t.length,N=new Map(s.map((k,T)=>[e(k,T,s),k])),y;for(g=0,a=new Array(p);g<_;++g)y=t[g],y.index=g,typeof y.source!="object"&&(y.source=oi(N,y.source)),typeof y.target!="object"&&(y.target=oi(N,y.target)),a[y.source.index]=(a[y.source.index]||0)+1,a[y.target.index]=(a[y.target.index]||0)+1;for(g=0,u=new Array(_);g<_;++g)y=t[g],u[g]=a[y.source.index]/(a[y.source.index]+a[y.target.index]);i=new Array(_),x(),o=new Array(_),w()}}function x(){if(s)for(var g=0,p=t.length;g<p;++g)i[g]=+n(t[g],g,t)}function w(){if(s)for(var g=0,p=t.length;g<p;++g)o[g]=+r(t[g],g,t)}return d.initialize=function(g,p){s=g,c=p,h()},d.links=function(g){return arguments.length?(t=g,h(),d):t},d.id=function(g){return arguments.length?(e=g,d):e},d.iterations=function(g){return arguments.length?(l=+g,d):l},d.strength=function(g){return arguments.length?(n=typeof g=="function"?g:Mt(+g),x(),d):n},d.distance=function(g){return arguments.length?(r=typeof g=="function"?g:Mt(+g),w(),d):r},d}const sl=1664525,al=1013904223,si=4294967296;function cl(){let t=1;return()=>(t=(sl*t+al)%si)/si}function ll(t){return t.x}function ul(t){return t.y}var fl=10,dl=Math.PI*(3-Math.sqrt(5));function $d(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,u=bn(f),c=te("tick","end"),l=cl();t==null&&(t=[]);function f(){d(),c.call("tick",e),n<i&&(u.stop(),c.call("end",e))}function d(w){var g,p=t.length,_;w===void 0&&(w=1);for(var N=0;N<w;++N)for(n+=(o-n)*r,a.forEach(function(y){y(n)}),g=0;g<p;++g)_=t[g],_.fx==null?_.x+=_.vx*=s:(_.x=_.fx,_.vx=0),_.fy==null?_.y+=_.vy*=s:(_.y=_.fy,_.vy=0);return e}function h(){for(var w=0,g=t.length,p;w<g;++w){if(p=t[w],p.index=w,p.fx!=null&&(p.x=p.fx),p.fy!=null&&(p.y=p.fy),isNaN(p.x)||isNaN(p.y)){var _=fl*Math.sqrt(.5+w),N=w*dl;p.x=_*Math.cos(N),p.y=_*Math.sin(N)}(isNaN(p.vx)||isNaN(p.vy))&&(p.vx=p.vy=0)}}function x(w){return w.initialize&&w.initialize(t,l),w}return h(),e={tick:d,restart:function(){return u.restart(f),e},stop:function(){return u.stop(),e},nodes:function(w){return arguments.length?(t=w,h(),a.forEach(x),e):t},alpha:function(w){return arguments.length?(n=+w,e):n},alphaMin:function(w){return arguments.length?(i=+w,e):i},alphaDecay:function(w){return arguments.length?(r=+w,e):+r},alphaTarget:function(w){return arguments.length?(o=+w,e):o},velocityDecay:function(w){return arguments.length?(s=1-w,e):1-s},randomSource:function(w){return arguments.length?(l=w,a.forEach(x),e):l},force:function(w,g){return arguments.length>1?(g==null?a.delete(w):a.set(w,x(g)),e):a.get(w)},find:function(w,g,p){var _=0,N=t.length,y,k,T,I,z;for(p==null?p=1/0:p*=p,_=0;_<N;++_)I=t[_],y=w-I.x,k=g-I.y,T=y*y+k*k,T<p&&(z=I,p=T);return z},on:function(w,g){return arguments.length>1?(c.on(w,g),e):c.on(w)}}}function hl(){var t,e,n,i,r=Mt(-30),o,s=1,a=1/0,u=.81;function c(h){var x,w=t.length,g=Mn(t,ll,ul).visitAfter(f);for(i=h,x=0;x<w;++x)e=t[x],g.visit(d)}function l(){if(t){var h,x=t.length,w;for(o=new Array(x),h=0;h<x;++h)w=t[h],o[w.index]=+r(w,h,t)}}function f(h){var x=0,w,g,p=0,_,N,y;if(h.length){for(_=N=y=0;y<4;++y)(w=h[y])&&(g=Math.abs(w.value))&&(x+=w.value,p+=g,_+=g*w.x,N+=g*w.y);h.x=_/p,h.y=N/p}else{w=h,w.x=w.data.x,w.y=w.data.y;do x+=o[w.data.index];while(w=w.next)}h.value=x}function d(h,x,w,g){if(!h.value)return!0;var p=h.x-e.x,_=h.y-e.y,N=g-x,y=p*p+_*_;if(N*N/u<y)return y<a&&(p===0&&(p=vt(n),y+=p*p),_===0&&(_=vt(n),y+=_*_),y<s&&(y=Math.sqrt(s*y)),e.vx+=p*h.value*i/y,e.vy+=_*h.value*i/y),!0;if(h.length||y>=a)return;(h.data!==e||h.next)&&(p===0&&(p=vt(n),y+=p*p),_===0&&(_=vt(n),y+=_*_),y<s&&(y=Math.sqrt(s*y)));do h.data!==e&&(N=o[h.data.index]*i/y,e.vx+=p*N,e.vy+=_*N);while(h=h.next)}return c.initialize=function(h,x){t=h,n=x,l()},c.strength=function(h){return arguments.length?(r=typeof h=="function"?h:Mt(+h),l(),c):r},c.distanceMin=function(h){return arguments.length?(s=h*h,c):Math.sqrt(s)},c.distanceMax=function(h){return arguments.length?(a=h*h,c):Math.sqrt(a)},c.theta=function(h){return arguments.length?(u=h*h,c):Math.sqrt(u)},c}function pl(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Ie(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function qt(t){return t=Ie(Math.abs(t)),t?t[1]:NaN}function wl(t,e){return function(n,i){for(var r=n.length,o=[],s=0,a=t[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),o.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=t[s=(s+1)%t.length];return o.reverse().join(e)}}function ml(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var gl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ze(t){if(!(e=gl.exec(t)))throw new Error("invalid format: "+t);var e;return new En({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ze.prototype=En.prototype;function En(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}En.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function yl(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var dr;function xl(t,e){var n=Ie(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(dr=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Ie(t,Math.max(0,e+o-1))[0]}function ai(t,e){var n=Ie(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const ci={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:pl,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ai(t*100,e),r:ai,s:xl,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function li(t){return t}var ui=Array.prototype.map,fi=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function vl(t){var e=t.grouping===void 0||t.thousands===void 0?li:wl(ui.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?li:ml(ui.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function c(f){f=ze(f);var d=f.fill,h=f.align,x=f.sign,w=f.symbol,g=f.zero,p=f.width,_=f.comma,N=f.precision,y=f.trim,k=f.type;k==="n"?(_=!0,k="g"):ci[k]||(N===void 0&&(N=12),y=!0,k="g"),(g||d==="0"&&h==="=")&&(g=!0,d="0",h="=");var T=w==="$"?n:w==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",I=w==="$"?i:/[%p]/.test(k)?s:"",z=ci[k],$=/[defgprs%]/.test(k);N=N===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function O(C){var L=T,b=I,m,S,v;if(k==="c")b=z(C)+b,C="";else{C=+C;var M=C<0||1/C<0;if(C=isNaN(C)?u:z(Math.abs(C),N),y&&(C=yl(C)),M&&+C==0&&x!=="+"&&(M=!1),L=(M?x==="("?x:a:x==="-"||x==="("?"":x)+L,b=(k==="s"?fi[8+dr/3]:"")+b+(M&&x==="("?")":""),$){for(m=-1,S=C.length;++m<S;)if(v=C.charCodeAt(m),48>v||v>57){b=(v===46?r+C.slice(m+1):C.slice(m))+b,C=C.slice(0,m);break}}}_&&!g&&(C=e(C,1/0));var A=L.length+C.length+b.length,E=A<p?new Array(p-A+1).join(d):"";switch(_&&g&&(C=e(E+C,E.length?p-b.length:1/0),E=""),h){case"<":C=L+C+b+E;break;case"=":C=L+E+C+b;break;case"^":C=E.slice(0,A=E.length>>1)+L+C+b+E.slice(A);break;default:C=E+L+C+b;break}return o(C)}return O.toString=function(){return f+""},O}function l(f,d){var h=c((f=ze(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(qt(d)/3)))*3,w=Math.pow(10,-x),g=fi[8+x/3];return function(p){return h(w*p)+g}}return{format:c,formatPrefix:l}}var ue,hr,pr;_l({thousands:",",grouping:[3],currency:["$",""]});function _l(t){return ue=vl(t),hr=ue.format,pr=ue.formatPrefix,ue}function kl(t){return Math.max(0,-qt(Math.abs(t)))}function bl(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qt(e)/3)))*3-qt(Math.abs(t)))}function Sl(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,qt(e)-qt(t))+1}function Nl(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Ml(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const di=Symbol("implicit");function Tn(){var t=new Bn,e=[],n=[],i=di;function r(o){let s=t.get(o);if(s===void 0){if(i!==di)return i;t.set(o,s=e.push(o)-1)}return n[s%n.length]}return r.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Bn;for(const s of o)t.has(s)||t.set(s,e.push(s)-1);return r},r.range=function(o){return arguments.length?(n=Array.from(o),r):n.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return Tn(e,n).unknown(i)},Nl.apply(r,arguments),r}function wr(t){return t}function Cl(t,e,n,i){var r=ao(t,e,n),o;switch(i=ze(i??",f"),i.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(o=bl(r,s))&&(i.precision=o),pr(i,s)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=Sl(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=kl(r))&&(i.precision=o-(i.type==="%")*2);break}}return hr(i)}function El(t){var e=t.domain;return t.ticks=function(n){var i=e();return so(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return Cl(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,o=i.length-1,s=i[r],a=i[o],u,c,l=10;for(a<s&&(c=s,s=a,a=c,c=r,r=o,o=c);l-- >0;){if(c=en(s,a,n),c===u)return i[r]=s,i[o]=a,e(i);if(c>0)s=Math.floor(s/c)*c,a=Math.ceil(a/c)*c;else if(c<0)s=Math.ceil(s*c)/c,a=Math.floor(a*c)/c;else break;u=c}return t},t}function Tl(){var t=0,e=1,n,i,r,o,s=wr,a=!1,u;function c(f){return f==null||isNaN(f=+f)?u:s(r===0?.5:(f=(o(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}c.domain=function(f){return arguments.length?([t,e]=f,n=o(t=+t),i=o(e=+e),r=n===i?0:1/(i-n),c):[t,e]},c.clamp=function(f){return arguments.length?(a=!!f,c):a},c.interpolator=function(f){return arguments.length?(s=f,c):s};function l(f){return function(d){var h,x;return arguments.length?([h,x]=d,s=f(h,x),c):[s(0),s(1)]}}return c.range=l(_n),c.rangeRound=l(ya),c.unknown=function(f){return arguments.length?(u=f,c):u},function(f){return o=f,n=f(t),i=f(e),r=n===i?0:1/(i-n),c}}function Al(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function pt(){var t=El(Tl()(wr));return t.copy=function(){return Al(t,pt())},Ml.apply(t,arguments)}function Il(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const mr=Il("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),fe=t=>()=>t;function zl(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function wt(t,e,n){this.k=t,this.x=e,this.y=n}wt.prototype={constructor:wt,scale:function(t){return t===1?this:new wt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new wt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var gr=new wt(1,0,0);wt.prototype;function Ke(t){t.stopImmediatePropagation()}function Xt(t){t.preventDefault(),t.stopImmediatePropagation()}function Dl(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Ol(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function hi(){return this.__zoom||gr}function $l(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Rl(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ll(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function Fl(){var t=Dl,e=Ol,n=Ll,i=$l,r=Rl,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,u=Ma,c=te("start","zoom","end"),l,f,d,h=500,x=150,w=0,g=10;function p(m){m.property("__zoom",hi).on("wheel.zoom",z,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",O).filter(r).on("touchstart.zoom",C).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",b).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(m,S,v,M){var A=m.selection?m.selection():m;A.property("__zoom",hi),m!==A?k(m,S,v,M):A.interrupt().each(function(){T(this,arguments).event(M).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},p.scaleBy=function(m,S,v,M){p.scaleTo(m,function(){var A=this.__zoom.k,E=typeof S=="function"?S.apply(this,arguments):S;return A*E},v,M)},p.scaleTo=function(m,S,v,M){p.transform(m,function(){var A=e.apply(this,arguments),E=this.__zoom,D=v==null?y(A):typeof v=="function"?v.apply(this,arguments):v,R=E.invert(D),P=typeof S=="function"?S.apply(this,arguments):S;return n(N(_(E,P),D,R),A,s)},v,M)},p.translateBy=function(m,S,v,M){p.transform(m,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof v=="function"?v.apply(this,arguments):v),e.apply(this,arguments),s)},null,M)},p.translateTo=function(m,S,v,M,A){p.transform(m,function(){var E=e.apply(this,arguments),D=this.__zoom,R=M==null?y(E):typeof M=="function"?M.apply(this,arguments):M;return n(gr.translate(R[0],R[1]).scale(D.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof v=="function"?-v.apply(this,arguments):-v),E,s)},M,A)};function _(m,S){return S=Math.max(o[0],Math.min(o[1],S)),S===m.k?m:new wt(S,m.x,m.y)}function N(m,S,v){var M=S[0]-v[0]*m.k,A=S[1]-v[1]*m.k;return M===m.x&&A===m.y?m:new wt(m.k,M,A)}function y(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function k(m,S,v,M){m.on("start.zoom",function(){T(this,arguments).event(M).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(M).end()}).tween("zoom",function(){var A=this,E=arguments,D=T(A,E).event(M),R=e.apply(A,E),P=v==null?y(R):typeof v=="function"?v.apply(A,E):v,it=Math.max(R[1][0]-R[0][0],R[1][1]-R[0][1]),B=A.__zoom,W=typeof S=="function"?S.apply(A,E):S,lt=u(B.invert(P).concat(it/B.k),W.invert(P).concat(it/W.k));return function(Q){if(Q===1)Q=W;else{var ut=lt(Q),He=it/ut[2];Q=new wt(He,P[0]-ut[0]*He,P[1]-ut[1]*He)}D.zoom(null,Q)}})}function T(m,S,v){return!v&&m.__zooming||new I(m,S)}function I(m,S){this.that=m,this.args=S,this.active=0,this.sourceEvent=null,this.extent=e.apply(m,S),this.taps=0}I.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,S){return this.mouse&&m!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var S=st(this.that).datum();c.call(m,this.that,new zl(m,{sourceEvent:this.sourceEvent,target:p,type:m,transform:this.that.__zoom,dispatch:c}),S)}};function z(m,...S){if(!t.apply(this,arguments))return;var v=T(this,S).event(m),M=this.__zoom,A=Math.max(o[0],Math.min(o[1],M.k*Math.pow(2,i.apply(this,arguments)))),E=dt(m);if(v.wheel)(v.mouse[0][0]!==E[0]||v.mouse[0][1]!==E[1])&&(v.mouse[1]=M.invert(v.mouse[0]=E)),clearTimeout(v.wheel);else{if(M.k===A)return;v.mouse=[E,M.invert(E)],ye(this),v.start()}Xt(m),v.wheel=setTimeout(D,x),v.zoom("mouse",n(N(_(M,A),v.mouse[0],v.mouse[1]),v.extent,s));function D(){v.wheel=null,v.end()}}function $(m,...S){if(d||!t.apply(this,arguments))return;var v=m.currentTarget,M=T(this,S,!0).event(m),A=st(m.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",it,!0),E=dt(m,v),D=m.clientX,R=m.clientY;Wi(m.view),Ke(m),M.mouse=[E,this.__zoom.invert(E)],ye(this),M.start();function P(B){if(Xt(B),!M.moved){var W=B.clientX-D,lt=B.clientY-R;M.moved=W*W+lt*lt>w}M.event(B).zoom("mouse",n(N(M.that.__zoom,M.mouse[0]=dt(B,v),M.mouse[1]),M.extent,s))}function it(B){A.on("mousemove.zoom mouseup.zoom",null),Qi(B.view,M.moved),Xt(B),M.event(B).end()}}function O(m,...S){if(t.apply(this,arguments)){var v=this.__zoom,M=dt(m.changedTouches?m.changedTouches[0]:m,this),A=v.invert(M),E=v.k*(m.shiftKey?.5:2),D=n(N(_(v,E),M,A),e.apply(this,S),s);Xt(m),a>0?st(this).transition().duration(a).call(k,D,M,m):st(this).call(p.transform,D,M,m)}}function C(m,...S){if(t.apply(this,arguments)){var v=m.touches,M=v.length,A=T(this,S,m.changedTouches.length===M).event(m),E,D,R,P;for(Ke(m),D=0;D<M;++D)R=v[D],P=dt(R,this),P=[P,this.__zoom.invert(P),R.identifier],A.touch0?!A.touch1&&A.touch0[2]!==P[2]&&(A.touch1=P,A.taps=0):(A.touch0=P,E=!0,A.taps=1+!!l);l&&(l=clearTimeout(l)),E&&(A.taps<2&&(f=P[0],l=setTimeout(function(){l=null},h)),ye(this),A.start())}}function L(m,...S){if(this.__zooming){var v=T(this,S).event(m),M=m.changedTouches,A=M.length,E,D,R,P;for(Xt(m),E=0;E<A;++E)D=M[E],R=dt(D,this),v.touch0&&v.touch0[2]===D.identifier?v.touch0[0]=R:v.touch1&&v.touch1[2]===D.identifier&&(v.touch1[0]=R);if(D=v.that.__zoom,v.touch1){var it=v.touch0[0],B=v.touch0[1],W=v.touch1[0],lt=v.touch1[1],Q=(Q=W[0]-it[0])*Q+(Q=W[1]-it[1])*Q,ut=(ut=lt[0]-B[0])*ut+(ut=lt[1]-B[1])*ut;D=_(D,Math.sqrt(Q/ut)),R=[(it[0]+W[0])/2,(it[1]+W[1])/2],P=[(B[0]+lt[0])/2,(B[1]+lt[1])/2]}else if(v.touch0)R=v.touch0[0],P=v.touch0[1];else return;v.zoom("touch",n(N(D,R,P),v.extent,s))}}function b(m,...S){if(this.__zooming){var v=T(this,S).event(m),M=m.changedTouches,A=M.length,E,D;for(Ke(m),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),E=0;E<A;++E)D=M[E],v.touch0&&v.touch0[2]===D.identifier?delete v.touch0:v.touch1&&v.touch1[2]===D.identifier&&delete v.touch1;if(v.touch1&&!v.touch0&&(v.touch0=v.touch1,delete v.touch1),v.touch0)v.touch0[1]=this.__zoom.invert(v.touch0[0]);else if(v.end(),v.taps===2&&(D=dt(D,this),Math.hypot(f[0]-D[0],f[1]-D[1])<g)){var R=st(this).on("dblclick.zoom");R&&R.apply(this,arguments)}}}return p.wheelDelta=function(m){return arguments.length?(i=typeof m=="function"?m:fe(+m),p):i},p.filter=function(m){return arguments.length?(t=typeof m=="function"?m:fe(!!m),p):t},p.touchable=function(m){return arguments.length?(r=typeof m=="function"?m:fe(!!m),p):r},p.extent=function(m){return arguments.length?(e=typeof m=="function"?m:fe([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),p):e},p.scaleExtent=function(m){return arguments.length?(o[0]=+m[0],o[1]=+m[1],p):[o[0],o[1]]},p.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],p):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},p.constrain=function(m){return arguments.length?(n=m,p):n},p.duration=function(m){return arguments.length?(a=+m,p):a},p.interpolate=function(m){return arguments.length?(u=m,p):u},p.on=function(){var m=c.on.apply(c,arguments);return m===c?p:m},p.clickDistance=function(m){return arguments.length?(w=(m=+m)*m,p):Math.sqrt(w)},p.tapDistance=function(m){return arguments.length?(g=+m,p):g},p}let fn=[];function Pl(t){{const e=fn.map(n=>n.id).join(`
`);t.nextDocumentMode="spw",t.valueStrings.push(e),fn=[]}}function yr(){window.spwashi.links.length=0}function Bl(t){window.spwashi.links=window.spwashi.links.filter(e=>e.source!==t&&e.target!==t)}function Rd(t){window.spwashi.links=window.spwashi.links.filter(e=>t.includes(e.source)&&t.includes(e.target))}function xr(t){return t.sort((e,n)=>e.z-n.z)}function Lt(t,e){const i=document.querySelector("#main-log").querySelector(".events-log");if(!i)return;const r=document.createElement("li");i.appendChild(r);const o=document.createElement("details");r.appendChild(o);const s=document.createElement("summary");if(o.appendChild(s),s.innerText=t,e){const a=document.createElement("pre");a.innerText=e,o.appendChild(a)}}function ql(t){const e=(n,i)=>{var o,s,a;if(fn.push(i),Lt("clicked: "+i.id,JSON.stringify(i,null,3)),(s=(o=i.callbacks)==null?void 0:o.click)==null||s.call(o,n,i),n.defaultPrevented)return;let r=window.spwashi.superpower.intent;if(n.key==="x"){i.fx=isNaN(i.fx)?i.x:i.fx;return}if(n.key==="y"){i.fy=isNaN(i.fy)?i.y:i.fy;return}if(n.shiftKey){i.fx=i.fy=void 0;return}if(!(n.key&&n.key!==" ")){switch(n.shiftKey&&(r*=-1),console.log(i),window.spwashi.superpower.name){case"hyperlink":const u=i.url||((a=i.getUrl)==null?void 0:a.call(i));if(i.url=u,!u)break;Lt("hyperlink: "+u);break;case"prune":window.spwashi.nodes.splice(window.spwashi.nodes.indexOf(i),1),Bl(i),window.spwashi.reinit();break;case"alert":if(!i.md5)return;navigator.clipboard.writeText(i.md5).then(c=>{alert(i.md5)});break;case"grow":{i.r+=r;break}case"shrink":{i.r-=r;break}case"colorindex":{i.color=void 0,isNaN(i.colorindex)&&(i.colorindex=1),i.colorindex+=r;break}case"z":{i.z=i.z||0,i.z+=r,xr(window.spwashi.nodes);break}}Gt()}};return t.append("circle").attr("data-colorindex",n=>"spwashi-datum-"+n.colorindex).attr("r",n=>n.r||1).attr("fill",n=>n.color||void 0).attr("cx",n=>n.x||0).attr("cy",n=>n.y||0).call($e().on("start",(n,i)=>{i.x=n.x,i.y=n.y}).on("drag",(n,i)=>{i.fx=n.x,i.fy=n.y}).on("end",(n,i)=>{window.spwashi.tick(),Gt()})).on("click",e).on("keydown",(n,i)=>{e(n,i)})}function Hl(t){t.select("circle").attr("stroke",e=>e.stroke).attr("stroke-width",e=>e.strokeWidth||5).attr("fill",e=>e.color||void 0).attr("data-colorindex",e=>e.color?void 0:"spwashi-datum-"+e.colorindex%13).attr("cx",e=>e.x||0).attr("r",e=>e.r||1).attr("cy",e=>e.y||0)}function Xl(t){const e=t.append("a");e.attr("href",i=>i.url||void 0),e.attr("target",i=>"_blank");const n=e.append("text");return n.attr("x",i=>i.x).attr("font-size",i=>i.text.fontSize||i.r).call($e().on("start",(i,r)=>{r.text.fx=r.text.fx||0,r.text.fy=r.text.fy||0,Lt("clicked: "+r.id,JSON.stringify(r,null,3))}).on("drag",(i,r)=>{r.fx=i.x,r.fy=i.y}).on("end",(i,r)=>{})),n.selectAll("tspan").data(i=>tn(i).split(`
`).map((r,o)=>({node:i,i:o,text:r}))).join(i=>i.append("tspan").attr("text-anchor","middle").attr("dy",r=>r.node.r*2).attr("dx",0),i=>i.selectAll("tspan").text(r=>r.text),i=>i.selectAll("tspan").remove()),t}function Yl(t){const e=t.select("a");return e.attr("href",i=>i.url||void 0),e.select("text").attr("x",i=>(i.x||0)+(i.text.fx||0)).attr("y",i=>(i.y||0)+(i.text.fy||0)-tn(i).split(`
`).length*i.r/2).attr("font-size",i=>i.text.fontSize||i.r).selectAll("tspan").data(i=>tn(i).split(`
`).map((r,o)=>({node:i,i:o,text:r}))).text(i=>i.text).attr("x",i=>(i.node.x||0)+(i.node.text.fx||0)),t}function Ul(t){return t.append("rect")}function Kl(t){return t.append("rect").attr("width",e=>window.spwashi.getNodeImageHref(e)?e.image.r||e.r:0).attr("height",e=>window.spwashi.getNodeImageHref(e)?e.image.r||e.r:0).attr("x",e=>e.x+e.image.offsetX-e.image.r/2).attr("y",e=>e.y+e.image.offsetY-e.image.r/2),t.append("image").attr("href",window.spwashi.getNodeImageHref).attr("width",e=>e.image.r||e.r).attr("height",e=>e.image.r||e.r).attr("preserveAspectRatio",e=>"xMidYMin slice").attr("x",e=>e.x+e.image.offsetX).attr("y",e=>e.y+e.image.offsetY).attr("stroke",Fi).attr("stroke-width",2).call($e().on("start",(e,n)=>{}).on("drag",(e,n)=>{n.image.offsetX+=e.dx,n.image.offsetY+=e.dy}).on("end",(e,n)=>{Gt()})).on("error",(e,n)=>{n.image.href=null,n.image.r=0}).on("click",(e,n)=>{if(event.defaultPrevented)return;let i=window.spwashi.superpower.intent;switch(e.shiftKey&&(i*=-1),window.spwashi.superpower.name){case"grow":{n.image.r=n.image.r||n.r,n.image.r+=i;break}case"shrink":{n.image.r=n.image.r||n.r,n.image.r-=i;break}case"colorindex":{isNaN(n.colorindex)&&(n.colorindex=1),n.colorindex+=i;break}}Gt()}),t}function Gl(t){t.select("rect").attr("stroke","black").attr("x",e=>e.x+e.image.offsetX-e.image.r/2).attr("y",e=>e.y+e.image.offsetY-e.image.r/2).attr("width",e=>window.spwashi.getNodeImageHref(e)?e.image.r:0).attr("height",e=>window.spwashi.getNodeImageHref(e)?e.image.r:0),t.select("image").attr("href",window.spwashi.getNodeImageHref).attr("width",e=>e.image.r).attr("height",e=>e.image.r).attr("x",e=>e.x+e.image.offsetX-e.image.r/2).attr("y",e=>e.y+e.image.offsetY-e.image.r/2)}function Vl(t){window.spwashi.nodes=t}function An(){window.spwashi.nodes=[]}function jl(){window.spwashi.nodes=window.spwashi.nodes.filter(t=>t.kind!=="__cluster"),window.spwashi.links=window.spwashi.links.filter(t=>t.source.kind!=="__cluster"&&t.target.kind!=="__cluster")}function Ld(t){window.spwashi.nodes.length=Math.max(0,window.spwashi.nodes.length-t)}function Jl(t,e,n){const i={image:{},callbacks:{},charge:0,parts:{},private:{},text:{fontSize:20},r:1*window.spwashi.parameters.nodes.radiusMultiplier,z:0,x:window.spwashi.parameters.startPos.x+n*2,y:window.spwashi.parameters.startPos.y,colorindex:ie()};return Object.assign(t,i,e,{name:t.identity||"node:"+n,idx:n},{...t}),t.r=Math.max(t.r,1),t.image.r=isNaN(t.image.r)?t.r:Math.max(10,t.image.r),t.image.offsetX=isNaN(t.image.offsetX)?0:t.image.offsetX,t.image.offsetY=isNaN(t.image.offsetY)?t.r:t.image.offsetY,t}function Wl(t,e=void 0){let n;return window.spwashi.nodes.find(r=>{if(r.identity===t)return n=n||r,e===void 0?!0:r.colorindex===e;r.id===t&&(n=n||r)})||n}const pi=new Map;function Ql(t={},e=0){return t.identity?t.identity:`node:[${e}]`}function Zl(t,e){const n=Ql(t,e),i=pi.get(n)||new Set;return i.has(t)||(t.id=n+(i.size?"["+i.size+"]":""),i.add(t)),t.id=t.id||n,pi.set(t.id,i),t.id}function tu(t){return!0}const G={getNode:Wl,initNodes:eu,normalize:Jl,updateNodes:nu,filterNode:tu,processNode:Zt,cacheNode:Gt};function eu(t){const e=t.length;for(let i=0;i<e;i++){const r={id:Zl(t[i],i)},o=Qr(r);G.normalize(t[i],{...r,...o},i)}const n=xr(t);return Vl(n),n}function nu(t,e){const n=t.select(".nodes").selectAll("g.wrapper").data(e,s=>s.id),i=s=>{const a=s.append("g").classed("wrapper",!0),u=a.append("g").classed("image",!0),c=a.append("g").classed("node",!0),l=a.append("g").classed("text",!0);return Kl(u),ql(c),Ul(c),Xl(l),a},r=s=>{const a=s.select("g.node"),u=s.select("g.image"),c=s.select("g.text");return Hl(a),Yl(c),Gl(u),a.select("rect").attr("stroke-width","1px").attr("fill",Zr).attr("stroke",Fi).attr("fill","none").attr("x",l=>l.x-l.r).attr("y",l=>l.y-l.r),s},o=s=>{s.select("g.node").remove(),s.select("g.text").remove(),s.select("g.image").remove()};n.join(i,r,o)}const iu="hotkey-menu",In="standard",zn="minimalism",ru="main-menu";function Dn(t){let e;if(t){const n=t.indexOf(document.body.dataset.interfaceDepth),i=t.filter((r,o)=>o!==n);e=i[n+1]||i[0]}else window.spwashi.minimalism?e=zn:e=In;document.body.dataset.interfaceDepth=e}function ou(){const t=document.querySelector("#mainmenu-toggle");t&&(t.onclick=()=>Dn([ru,window.spwashi.minimalism?zn:In]))}function su(){Dn([iu,window.spwashi.minimalism?zn:In])}function au(){const t=document.querySelector("#keystroke-options");t.innerHTML="";const e=document.querySelector("#hotkey-menu-toggle");e.onclick=i=>{su()};const n=t.appendChild(document.createElement("UL"));window.spwashi.keystrokeOptions.filter(i=>i.revealOrder<=window.spwashi.keystrokeRevealOrder).forEach(({shortcut:i,categories:r=[],title:o,callback:s,shortcutName:a})=>{const u=()=>{s()},c=n.appendChild(document.createElement("LI"));if(!o)return;const l=c.appendChild(document.createElement("SPAN"));l.className="ctg",l.innerHTML=r.map(h=>`<span>[${h}]</span>`).join("");const f=c.appendChild(document.createElement("BUTTON"));f.onclick=u,f.innerHTML=o;const d=c.appendChild(document.createElement("KBD"));d.innerHTML=`ctrl + <strong>${a||i}</strong>`})}function j(...t){window.spwashi.nodes.push(...t)}function cu(t){return window.spwashi.nodes.map(t)}function q(t){window.spwashi.nodes.forEach(t)}function Fd(t){return window.spwashi.nodes.filter((e,n)=>!t(e,n))}function lu(t){return window.spwashi.nodes.filter(e=>e.x>t.x&&e.x<t.x+t.width&&e.y>t.y&&e.y<t.y+t.height)}function J(){return window.spwashi.nodes}function _t(t,...e){return t.push(...e),t}function vr(t){const e=[],n=window.spwashi.parameters.links.strength;let i=!1;for(let r of t){if(!(r.identity&&r.parts))continue;const{head:o,body:s,tail:a}=r.parts;[o,s,a].flat().map(c=>c==null?void 0:c.identity).filter(Boolean).forEach(c=>{const l=typeof c=="string"?c:c.identity,f=!!window.spwashi.parameters.perspective,d=window.spwashi.getNode(l,f?r.colorindex:void 0);if(!d){i=!0;return}let h=1;switch(d.kind.trim()){case"operator + delimiter + essential.open":case"operator + delimiter + essential.close":h=5;break;case"operator + delimiter + locational.open":case"operator + delimiter + locational.close":h=5;break;case"operator + delimiter + conceptual.open":case"operator + delimiter + conceptual.close":h=5;break}switch(r.kind.trim()){case"phrasal":h=7;break}const x=n*h,w={source:d.id,target:r.id,strength:x};_t(e,w)})}return i&&console.error(t),e}function uu(t){return _t(window.spwashi.links,...vr(t))}function fu(t,e){t.select(".links").selectAll("line").data(e).join(n=>n.append("line").attr("stroke-width",i=>(i.strength||1)*13).attr("x1",i=>i.source.x).attr("y1",i=>i.source.y).attr("x2",i=>i.target.x).attr("y2",i=>i.target.y),n=>n.attr("x1",i=>i.source.x).attr("data-colorindex",i=>"spwashi-stroke-"+i.colorindex).attr("y1",i=>i.source.y).attr("x2",i=>i.target.x).attr("y2",i=>i.target.y),n=>n.remove())}const dn={initLinks:uu,updateLinks:fu};function du(t,e){t.select(".rects").selectAll("g.rect").data(e,n=>n.title).join(n=>{const i=n.append("g").classed("rect",!0);i.append("rect").attr("width",r=>Math.abs(r.width)).attr("height",r=>r.height||5).attr("x",r=>r.x).attr("y",r=>r.y).attr("fill",r=>r.fill||"teal").attr("stroke","yellow").attr("stroke-width",1).attr("pointer-events","all").on("click",()=>{}),i.append("text").attr("text-anchor","start").attr("x",r=>30).attr("y",r=>r.y+15).text(r=>r.title)},n=>{n.selectAll("rect").attr("fill",i=>i.fill||"teal").attr("width",i=>Math.abs(i.width||0)).attr("height",i=>Math.abs(i.height||0)).attr("y",i=>i.y).attr("x",i=>i.x),n.selectAll("text").text(i=>i.title)})}const wi={initRects:t=>t,updateRects:du};function _r(){const t=window.spwashi.simulation,e=window.spwashi.links,n=J();t.alpha(window.spwashi.parameters.forces.alpha),t.alphaTarget(window.spwashi.parameters.forces.alphaTarget),t.alphaDecay(window.spwashi.parameters.forces.alphaDecay),t.velocityDecay(window.spwashi.parameters.forces.velocityDecay),t.force("link",ol().links(e).id(i=>i.id).strength(i=>i.strength||1)),t.force("collide",il(i=>i.collisionRadius||i.r)),t.force("charge",null),t.force("charge",hl().strength(i=>i.charge||window.spwashi.parameters.forces.charge)),t.force("center",Fc(window.spwashi.parameters.forces.centerPos.x,window.spwashi.parameters.forces.centerPos.y).strength(window.spwashi.parameters.forces.centerStrength)),t.force("boundingBox",null),window.spwashi.parameters.forces.boundingBox&&t.force("boundingBox",i=>{for(let r=0,o=n.length,s=i*.1;r<o;++r){const a=n[r];a.x>window.spwashi.parameters.width?(a.x=window.spwashi.parameters.width,a.vx*=.9):a.x<0&&(a.x=0,a.vx*=.9),a.y>window.spwashi.parameters.height?(a.y=window.spwashi.parameters.height,a.vy*=.9):a.y<0&&(a.y=0,a.vy*=.9)}})}const bt=st("svg#simulation"),Ft=bt.append("g").attr("id","simulation-content");Ft.append("g").classed("rects",!0);const hu=Ft.append("g").classed("links",!0),pu=Ft.append("g").classed("nodes",!0),Dt={x:0,y:0},Ot={x:0,y:0};function wu(){if(window.spwashi.parameters.canzoom)bt.call(Fl().on("zoom",(t,e)=>{const n=(t.transform.k-1)*10;window.spwashi.zoomTransform={k:n},t.sourceEvent.shiftKey?(window.spwashi.parameters.forces._charge=window.spwashi.parameters.forces._charge||window.spwashi.parameters.forces.charge,window.spwashi.parameters.forces.charge=window.spwashi.parameters.forces._charge*n,tt()):q(i=>{i.private._r=i.private._r||i.r,i.r=i.private._r*t.transform.k})})).on("dblclick.zoom",null);else if(window.spwashi.parameters.canpan)bt.call($e().on("start",t=>{bt.attr("cursor","grabbing"),Dt.x=t.x,Dt.y=t.y}).on("drag",t=>{const e=Dt.x-t.x,n=Dt.y-t.y;Ot.x+=e/10,Ot.y+=n/10,pu.attr("transform",`translate(${Ot.x}, ${Ot.y})`),hu.attr("transform",`translate(${Ot.x}, ${Ot.y})`)}).on("end",t=>{bt.attr("cursor","grab"),Dt.x=t.x,Dt.y=t.y}));else{let t=null;bt.on("mousedown",e=>{t={x:e.offsetX,y:e.offsetY,calc:n=>n,width:1,height:1},window.spwashi.rects.push(t),Lt("mousedown:"+e.y+" "+e.x)}).on("mousemove",e=>{if(!t)return 0;t.width=e.offsetX-t.x,t.height=e.offsetY-t.y}).on("mouseup",e=>{const n=lu(t),i=Pn(n,a=>a.x),r=(i[1]-i[0])/n.length,o=Pn(n,a=>a.y),s=(o[1]-o[0])/n.length;Lt(i+" "+o),n.forEach((a,u)=>{a.fx=i[0]+r*u,a.fy=o[0]+s*u,a.charge=-1e3}),window.spwashi.rects.splice(window.spwashi.rects.indexOf(t),1),tt(),t=null,Lt("mouseup:"+e.y+" "+e.x)})}}function tt(){window.spwashi.counter=0,bt.attr("width",window.spwashi.parameters.width).attr("height",window.spwashi.parameters.height).attr("preserveAspectRatio","xMinYMin meet"),wu();const t=G.initNodes(window.spwashi.nodes),e=dn.initLinks(t),n=wi.initRects(window.spwashi.rects),i=window.spwashi.simulation;i.nodes(t),_r(),window.spwashi.tick=()=>{i.tick(1),window.spwashi.internalTicker()},window.spwashi.internalTicker=()=>{window.spwashi.counter+=1,n.forEach(r=>r.calc(r)),dn.updateLinks(Ft,e),G.updateNodes(Ft,t),wi.updateRects(Ft,n)},i.on("tick",window.spwashi.internalTicker),document.querySelector("#output").innerHTML=JSON.stringify(window.spwashi.parameters,null,2)}function Pd(t){return{identity:t.identity,name:t.name,x:t.x,y:t.y,fx:t.fx,fy:t.fy,r:t.r,id:t.id,image:t.image.href?t.image:void 0,md5:t.md5,colorindex:t.colorindex}}function kr(t){const e=JSON.parse(t);return Array.isArray(e)?{nodes:e||[],links:[]}:e.nodes&&Array.isArray(e.nodes)?{nodes:e.nodes,links:e.links||[]}:(console.error("not nodes"),{nodes:[],links:[]})}function Bd(){window.spwashi.refreshNodeInputs=n=>{const i=document.querySelector("#nodes-input"),r=window.spwashi.getItem("parameters.nodes-input")||[];i.value=JSON.stringify(r)},window.spwashi.readNodeInputs=()=>{var i;const n=(i=document.querySelector("#nodes-input"))==null?void 0:i.value;return n?kr(n):(window.spwashi.setItem("parameters.nodes-input",null),reject())},window.spwashi.refreshNodeInputs(),j(...window.spwashi.readNodeInputs().nodes.filter(G.filterNode)),q(Zt),tt();const t=document.querySelector("#nodes-input");t.onfocus=()=>t.select();const e=(n=!0)=>{const i=window.spwashi.readNodeInputs().nodes;n||(An(),tt()),j(...i),tt(),V("")};document.querySelector("#controls button.read-nodes").onclick=()=>e(!0),document.querySelector("#node-input-container button.add").onclick=()=>e(!0),document.querySelector("#node-input-container button.replace").onclick=()=>e(!1),document.querySelector("#controls button.save-nodes").onclick=()=>{const n=J();n.map(G.cacheNode),window.spwashi.setItem("parameters.nodes-input",n),window.spwashi.refreshNodeInputs()},document.querySelector("#controls button.clear-saved-nodes").onclick=()=>{const n=J();n.map(i=>{const r=i.id;for(let o in i)delete i[o];i.id=r,G.cacheNode(i)}),n.length=0,tt(),V("")}}function br(t){const e=kr(t);if(e.nodes.length===0)return!1;const n=e.nodes.filter(G.filterNode);n.forEach(G.processNode),j(...n);const i=dn.initLinks(e.links,n);_t(window.spwashi.links,...i),tt()}function mu(t){window.spwashi.keystrokeOptions=t}mn(()=>import("./keystrokes-1VpVQ2PX.js"),__vite__mapDeps([])).then(({initialKeyStrokeOptions:t})=>{window.spwashi.keystrokeOptions=t,mu(t)});function gu(){ou(),window.spwashi.keystrokeRevealOrder=window.spwashi.keystrokeRevealOrder||0,au();function t(e,n){const i=window.spwashi.modeOrder.map((o,s)=>[s+1,()=>V(o,!0,!0)]),r=Object.fromEntries(i);if(!["INPUT","TEXTAREA"].includes(document.activeElement.tagName)){if(e==="/"){n.preventDefault(),document.querySelector("h1").click();return}if(r[e]){n&&n.preventDefault(),r[e]();return}switch(e){case"ArrowRight":window.spwashi.callbacks.arrowRight();break;case"ArrowLeft":window.spwashi.callbacks.arrowLeft();break;case"ArrowUp":window.spwashi.callbacks.arrowUp();break;case"ArrowDown":window.spwashi.callbacks.arrowDown();break}}}document.addEventListener("paste",e=>{if(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA")return;const i=(e.clipboardData||window.clipboardData).getData("Text");return br(i)}),document.addEventListener("keydown",e=>{const n=e.key;if(n==="Escape"&&(document.querySelector("#mode-container :is(:focus)"),V("")),!e.shiftKey){if(e.metaKey||e.ctrlKey){for(let i of window.spwashi.keystrokeOptions)n===i.shortcut&&(e.preventDefault(),i.callback());return}t(n,e)}})}const Sr="extended menu".trim();function yu(){window.spwashi.keystrokeRevealOrder=1,gu()}function xu(){An(),yr(),window.spwashi.perspectiveMap.delete(ie()),tt()}const vu=(t,e)=>t.fy=75*(e+1),_u=(t,e)=>t.fx=75;async function*ku(t){for(let{delay:e,payload:n}of t)await new Promise(i=>setTimeout(i,e)),yield n}async function Nr(t){for await(const e of ku(t)){if(e.effect&&e.effect(),e.params&&Fe(new URLSearchParams(e.params)),e.nodes){const n=e.nodes.map(Zt).map(G.normalize);j(...n)}window.window.spwashi.reinit()}}function On(t){const e=document.querySelector("#spw-parse-field");e.value=t,e.focus();const n=e.value.indexOf("&");e.setSelectionRange(n,n+1)}function bu(){for(let t in Ct)Ct.hasOwnProperty(t)&&delete Ct[t]}function Mr(){return["< & >","( & )","{ & }","[ & ]"]}function Cr(){return["context","topic","structure","status"]}const Ge=Mr(),Ve=Cr();function De(t=!1){bu();const e=Ve.shift();if(!e||t){Ge.length=0,Ve.length=0,Ge.push(...Mr()),Ve.push(...Cr()),De();return}Ct[e]={params:{superpower:"hyperlink"},events:[{delay:300,payload:{params:{mode:"spw"}}},{delay:300,payload:{effect:()=>On(Ge.shift())}},{delay:300,payload:{effect:De}}]},Su()}const Ct={};De();Ct.demo={params:{width:300,height:500,superpower:"hyperlink",velocityDecay:.9,center:"150,250"},runStory:()=>{Nr([{delay:50,payload:{nodes:[{r:10,x:30,y:50,text:{fx:75,fontSize:30},name:"hello"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:100,text:{fx:75,fontSize:30},name:"how"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:150,text:{fx:75,fontSize:30},name:"are"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:200,text:{fx:75,fontSize:30},name:"you"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:250,text:{fx:75,fontSize:30},name:"doing"}]}},{delay:50,payload:{nodes:[{r:10,x:30,y:300,text:{fx:75,fontSize:30},name:"today"}]}},{delay:300,payload:{params:{charge:500}}},{delay:50,payload:{params:{charge:0}}},{delay:50,payload:{effect:()=>q((i,r)=>(_u(i),vu(i,r)))}},{delay:300,payload:{effect:()=>xu()}},{delay:100,payload:{params:{mode:"spw"}}},{delay:300,payload:{effect:()=>On("i am doing & today")}}]).then(console.log)}};Ct.options={events:[{delay:300,payload:{params:{mode:"spw"}}},{delay:100,payload:{effect:()=>On(Sr)}},{delay:1e3,payload:{effect:()=>{window.spwashi.keystrokeRevealOrder=1}}}]};function Su(){const t=document.querySelector("#story-mode-container");t.innerHTML="";const e=document.createElement("div");e.classList.add("button-container"),t.appendChild(e),Object.entries(Ct).forEach(([n,i])=>{const r=document.createElement("button");r.innerText=n,r.onclick=()=>{Fe(new URLSearchParams(i.params)),i.runStory&&i.runStory(),i.events&&Nr(i.events)},e.appendChild(r)})}function Er(t){document.body.dataset.dataindex=t,window.spwashi.onDataIndexChange(t)}function ie(){return parseInt((document.body.dataset.dataindex||"0").split("-").reverse()[0])}function qd(){const t=document.querySelector("#colors");t.onclick=function(e){const i=e.target.dataset.dataindex;Er(i),V(null)}}const Nu="spwashi-datum-";function Tr(t){return Nu+t%13}function Mu(){De(!0),document.querySelector(`#colors button[data-dataindex=${Tr(ie())}]`).focus();const t=document.querySelectorAll("#colors button"),e={},n={};t.forEach(o=>{const s=o.getBoundingClientRect(),a=Math.round(s.x),u=Math.round(s.y);e[a]||(e[a]=[]),n[u]||(n[u]=[]),e[a].push(o),n[u].push(o)});const i=Object.keys(e).sort((o,s)=>o-s).map((o,s)=>{const a=e[o];return a.forEach(u=>u.dataset.x=s),a}),r=Object.keys(n).sort((o,s)=>o-s).map((o,s)=>{const a=n[o];return a.forEach(u=>u.dataset.y=s),a});window.spwashi.callbacks.arrowUp=()=>{const o=parseInt(document.activeElement.dataset.x),s=i[o],a=s.indexOf(document.activeElement),u=a?a-1:s.length-1;s[u].focus()},window.spwashi.callbacks.arrowDown=()=>{const o=parseInt(document.activeElement.dataset.x),s=i[o],a=s.indexOf(document.activeElement),u=a===s.length-1?0:a+1;s[u].focus()},window.spwashi.callbacks.arrowRight=()=>{const o=parseInt(document.activeElement.dataset.y),s=r[o],a=s.indexOf(document.activeElement),u=a===s.length-1?0:a+1;s[u].focus()},window.spwashi.callbacks.arrowLeft=()=>{const o=parseInt(document.activeElement.dataset.y),s=r[o],a=s.indexOf(document.activeElement),u=a?a-1:s.length-1;s[u].focus()}}function Cu(){window.spwashi.parameters=window.spwashi.parameters||{},window.spwashi.parameters.debug=!1,window.spwashi.parameters.perspective=window.spwashi.parameters.perspective||void 0,window.spwashi.parameters.dataIndex=window.spwashi.parameters.dataIndex||null,window.spwashi.parameters.width=window.spwashi.parameters.width||window.innerWidth*.9,window.spwashi.parameters.height=window.spwashi.parameters.height||window.innerHeight*.9,window.spwashi.parameters.startPos=window.spwashi.parameters.startPos||{},window.spwashi.parameters.startPos.x=window.spwashi.parameters.startPos.x||window.spwashi.parameters.width/2,window.spwashi.parameters.startPos.y=window.spwashi.parameters.startPos.y||window.spwashi.parameters.height/2,window.spwashi.parameters.links=window.spwashi.parameters.links||{},window.spwashi.parameters.links.strength=window.spwashi.parameters.links.strength||.1,window.spwashi.parameters.nodes=window.spwashi.parameters.nodes||{},window.spwashi.parameters.nodes.count=window.spwashi.parameters.nodes.count||13,window.spwashi.parameters.nodes.radiusMultiplier=window.spwashi.parameters.nodes.radiusMultiplier||30,window.spwashi.parameters.forces=window.spwashi.parameters.forces||{},window.spwashi.parameters.forces.alpha=window.spwashi.parameters.forces.alpha||1,window.spwashi.parameters.forces.alphaTarget=window.spwashi.parameters.forces.alphaTarget||.3,window.spwashi.parameters.forces.alphaDecay=window.spwashi.parameters.forces.alphaDecay||.03,window.spwashi.parameters.forces.velocityDecay=window.spwashi.parameters.forces.velocityDecay||.91,window.spwashi.parameters.forces.charge=window.spwashi.parameters.forces.charge||10,window.spwashi.parameters.forces.centerStrength=window.spwashi.parameters.forces.centerStrength||1,window.spwashi.parameters.forces.boundingBox=typeof window.spwashi.parameters.forces.boundingBox<"u"?window.spwashi.parameters.forces.boundingBox:!0,window.spwashi.parameters.forces.centerPos=window.spwashi.parameters.forces.centerPos||{},window.spwashi.parameters.forces.centerPos.x=window.spwashi.parameters.forces.centerPos.x||window.spwashi.parameters.startPos.x,window.spwashi.parameters.forces.centerPos.y=window.spwashi.parameters.forces.centerPos.y||window.spwashi.parameters.startPos.y}function Fe(t){var i;[...t.entries()].forEach(([r,o])=>(document.querySelector(`[name=${r}]`)||{}).value=o),window.spwashi.parameters=window.spwashi.parameters||{},window.spwashi.values=window.spwashi.values||{},window.spwashi.values.fy=[],window.spwashi.values.r=[],window.spwashi.values.text=window.spwashi.values.text||{},window.spwashi.values.text.fontSize=window.spwashi.values.text.fontSize||[],window.spwashi.superpower=window.spwashi.superpower||{name:"hyperlink",intent:1},window.spwashi.parameters.links=window.spwashi.parameters.links||{},window.spwashi.parameters.forces=window.spwashi.parameters.forces||{},window.spwashi.featuredIdentity=((i=/\/identity\/([a-zA-Z\d]+)/.exec(window.location.href))==null?void 0:i[1])||t.get("identity");const e=`spwashi.parameters#${window.spwashi.featuredIdentity}`;window.spwashi.parameterKey=e,console.log({parameterKey:e});let n;if(t.get("title")&&(document.title=t.get("title"),document.querySelector("h1").innerText=t.get("title")),t.has("perspective")&&(window.spwashi.parameters.perspective=t.get("perspective")!=="0"),t.has("display")&&(document.body.dataset.displaymode=t.get("display")),t.has("reset")&&window.localStorage.clear(),t.has("nodeCount")&&(window.spwashi.parameters.nodes=window.spwashi.parameters.nodes||{},window.spwashi.parameters.nodes.count=+t.get("nodeCount")),t.has("linkStrength")&&(window.spwashi.parameters.links.strength=+t.get("linkStrength")),t.has("charge")&&(window.spwashi.parameters.forces.charge=+t.get("charge")),t.has("linkStyle")?window.spwashi.parameters.links.linkPrev=t.get("linkStyle")==="prev":window.spwashi.parameters.links.linkPrev=0,t.has("width")&&(window.spwashi.parameters.width=+t.get("width")),t.has("size")&&(window.spwashi.parameters.width=+t.get("size").split(",")[0],window.spwashi.parameters.height=+t.get("size").split(",")[0]),t.has("height")&&(window.spwashi.parameters.height=+t.get("height")),t.has("centerStrength"),t.has("center")){let[r,o]=t.get("center").split(",").map(s=>+s);o=o||r,window.spwashi.parameters.startPos={x:r,y:o},window.spwashi.parameters.forces.centerPos={x:r,y:o}}else{let[r,o]=[window.spwashi.parameters.width,window.spwashi.parameters.height].map(s=>s/2);window.spwashi.parameters.startPos={x:r,y:o},window.spwashi.parameters.forces.centerPos={x:r,y:o}}t.has("alpha")&&(window.spwashi.parameters.forces.alpha=+t.get("alpha")),t.has("alphaTarget")&&(window.spwashi.parameters.forces.alphaTarget=+t.get("alphaTarget")),t.has("alphaDecay")&&(window.spwashi.parameters.forces.alphaDecay=+t.get("alphaDecay")),t.has("velocityDecay")&&(window.spwashi.parameters.forces.velocityDecay=+t.get("velocityDecay")),t.has("zoom")?window.spwashi.parameters.canzoom=!!+t.get("zoom"):window.spwashi.parameters.canzoom=!0,t.has("superpower")&&(window.spwashi.superpower.name=t.get("superpower")),t.has("intent")&&(window.spwashi.superpower.intent=parseInt(t.get("intent")||1)),t.has("mode")&&(n=t.get("mode"),setTimeout(()=>V(n,!1),500)),t.has("fx")&&(window.spwashi.values.fx=t.get("fx").split(",").map(r=>+r)),t.has("fy")&&(window.spwashi.values.fy=t.get("fy").split(",").map(r=>+r)),t.has("r")&&(window.spwashi.values.r=t.get("r").split(",").map(r=>+r)),t.has("defaultRadius")&&(window.spwashi.parameters.nodes.radiusMultiplier=+t.get("defaultRadius")),t.has("fontSize")&&(window.spwashi.values.text.fontSize=t.get("fontSize").split(",").map(r=>+r)),t.has("doFetch")&&(window.spwashi.doFetchNodes=t.get("dofetch")==="1"),t.has("boundingBox")&&(window.spwashi.parameters.forces.boundingBox=t.get("boundingBox")==="1"),t.has("dataindex")&&(window.spwashi.parameters.dataIndex=+t.get("dataindex"),Er(Tr(window.spwashi.parameters.dataIndex))),t.has("debug")&&(window.spwashi.parameters.debug=!0,document.body.dataset.debug="debug"),window.spwashi.initialMode=n}let rt;const yt={ready:!0},et={x:0,y:0,queuedAction:()=>{const t=window.spwashi.getItem("mode","focal.root");V(t)},onFocus:()=>{}};function mi(t,e=500){t.classList.add("consent-to-engage");const n={interested:null,revoke:r},i=setTimeout(()=>{t.classList.remove("consent-to-engage"),t.classList.add("consented-to-engage"),n.interested=!0},e);function r(){clearTimeout(i),t.classList.remove("consented-to-engage"),t.classList.remove("consent-to-engage"),n.interested=!1}return n}function Pe(){if(!rt){rt=document.querySelector("#focal-square");const t=window.spwashi.getItem("focalPoint","focal.root");t&&(Object.assign(et,t),Kt(et,!0)),rt.onmousedown=e=>{e.preventDefault();const n=mi(rt,100);document.documentElement.onmousemove=i=>{n.interested&&(i.preventDefault(),yt.ready=!1,Kt({x:i.x,y:i.y},!0))},document.documentElement.onmouseup=i=>{i.preventDefault(),n.revoke(),yt.ready||setTimeout(()=>yt.ready=!0,100),document.documentElement.onmousemove=null,document.documentElement.onmouseup=null}},rt.ontouchstart=e=>{e.preventDefault();const n=mi(rt,300);document.documentElement.ontouchmove=i=>{i.preventDefault(),n.interested&&(yt.ready=!1,Kt({x:i.touches[0].clientX,y:i.touches[0].clientY},!0))},document.documentElement.ontouchend=i=>{i.preventDefault(),n.interested||(yt.ready=!0,rt.onclick(i)),n.revoke(),yt.ready||setTimeout(()=>yt.ready=!0,100),document.documentElement.ontouchmove=null,document.documentElement.ontouchend=null}}}return rt.onclick=t=>{yt.ready&&et.queuedAction()},rt.onfocus=t=>{et.onFocus()},rt}function Kt({x:t,y:e},n=!1){et.x=t,et.y=e,n&&(et.fx=t,et.fy=e),document.documentElement.style.setProperty("--focal-x",t+"px"),document.documentElement.style.setProperty("--focal-y",e+"px"),window.spwashi.setItem("focalPoint",{x:t,y:e,fx:t,fy:e},"focal.root")}document.documentElement.style.setProperty("--focal-y-basis",document.documentElement.getBoundingClientRect().height+"px");function Eu(t){const e=t.getBoundingClientRect().x,n=t.getBoundingClientRect().y,i=t.getBoundingClientRect().width,r=t.getBoundingClientRect().height,o=e+i,s=n+r;(et.fx===void 0||et.fy===void 0)&&Kt({x:o,y:s})}const Tu=["thoughts are nodes","text can be linked"];function Ar(t){j(...[{id:"help--home",name:"home",description:"go to home page",r:30,url:"/"}].map(n=>(n.fy=t,n))),window.spwashi.reinit()}function Au(t){{window.spwashi.setItem("help",Tu.join(`
`),"focal.root"),j({fx:window.spwashi.parameters.startPos.x,fy:window.spwashi.parameters.startPos.y,id:"help",name:"help",kind:"__help",r:30,collisionRadius:100,charge:-100,url:"/help",callbacks:{click(e,n){n.fx=n.fy=void 0;const i=n.y;n.x,Ar(i)}}}),t.physicsChange=!0;return}}function Iu(){window.spwashi.callbacks=window.spwashi.callbacks||{},window.spwashi.callbacks.arrowRight=()=>{},window.spwashi.callbacks.arrowLeft=()=>{},window.spwashi.callbacks.arrowUp=()=>{},window.spwashi.callbacks.arrowDown=()=>{}}function zu(){document.body.addEventListener("mousedown",t=>{t.target.tagName!=="BUTTON"&&t.target.tagName!=="CIRCLE"&&document.body.dataset.interfaceDepth==="standard"&&Pe()},!0)}const gi="center";let je=null;function Du(){return je=je||{identity:gi,r:0,collisionRadius:100,x:window.spwashi.parameters.width/2,y:window.spwashi.parameters.height/2},j(je),gi}function Ou(t){const e=Du();window.spwashi.reinit();const n=[];for(let i of t){const r={source:i.id,target:window.spwashi.getNode(e).id,strength:.1};_t(n,r)}return n}const $u="spwashi-action-";function Ru(t){return $u+t}function Hd(){window.spwashi.boon=()=>{async function*u(l=100,f=window.spwashi.parameters.nodes.count){for(let d=0;d<f;d++)yield d,await new Promise(h=>setTimeout(h,l))}async function c(){let l=[];for await(const f of u()){const d={name:"#",r:30,color:"wheat",colorindex:ie()};j(d),window.spwashi.reinit(),l.push(d)}return l}return c()},window.spwashi.bane=u=>{async function*c(f,d){let h=u||J();for(let x=100;x--;x>0)for(let w of h)yield w,await new Promise(g=>setTimeout(g,f))}async function l(){let f=[];for await(const d of c(10))d.r=Math.min(d.r*Math.random(),100),d.r=Math.max(d.r*Math.random(),10);return f}return l()},window.spwashi.bone=()=>{const u=new Map;for(let c of window.spwashi.nodes){const l=u.get(c.colorindex)||[];l.push(c),u.set(c.colorindex,l)}[...u.values()].forEach(c=>{let l,f;for(let d of c){f=f||d;let h=window.spwashi.getNode(l==null?void 0:l.id),x=window.spwashi.getNode(d.id);const w={source:x,target:h,colorindex:x.colorindex,strength:window.spwashi.parameters.links.strength*.3};x&&_t(window.spwashi.links,w),l=d}_t(window.spwashi.links,{source:l==null?void 0:l.id,target:f==null?void 0:f.id,strength:window.spwashi.parameters.links.strength*.3})}),window.spwashi.reinit()},window.spwashi.bonk=u=>{(u||window.spwashi.nodes).forEach(c=>(c.color=void 0,c.colorindex+=1)),window.spwashi.reinit()},window.spwashi.honk=()=>{window.spwashi.links.forEach(u=>u.strength*=1.5),window.spwashi.reinit()};const o=[{title:"Lore",reflexes:[["boon",()=>{window.spwashi.boon()}],["bone",()=>{window.spwashi.bone()}],["honk",()=>{window.spwashi.honk()}],["bane",()=>{window.spwashi.bane(),window.spwashi.reinit()}],["bonk",()=>{window.spwashi.bonk()}]]},{title:"Set Charge",reflexes:[["-100",()=>{window.spwashi.parameters.forces.charge=-100,window.spwashi.reinit()}],["0",()=>{window.spwashi.parameters.forces.charge=0,window.spwashi.reinit()}],["100",()=>{window.spwashi.parameters.forces.charge=100,window.spwashi.reinit()}],["-1k",()=>{window.spwashi.parameters.forces.charge=-1e3,window.spwashi.reinit()}],["-10k",()=>{window.spwashi.parameters.forces.charge=-1e4,window.spwashi.reinit()}]]},{title:"Adjust Radius",reflexes:[["*=3.2",()=>{q(u=>u.r*=3.2),window.spwashi.reinit()}],["/=2.3",()=>{q(u=>u.r/=2.3),window.spwashi.reinit()}],["=10",()=>{q(u=>u.r=10),window.spwashi.reinit()}]]},{title:"Adjust Charge",reflexes:[["-100",()=>{window.spwashi.parameters.forces.charge-=100,window.spwashi.reinit()}],["-10",()=>{window.spwashi.parameters.forces.charge-=10,window.spwashi.reinit()}],["*-1",()=>{window.spwashi.parameters.forces.charge*=-1,window.spwashi.reinit()}],["+10",()=>{window.spwashi.parameters.forces.charge+=10,window.spwashi.reinit()}],["*13",()=>{window.spwashi.parameters.forces.charge*=10,window.spwashi.reinit()}]]},{title:"Forces",reflexes:[["link",()=>{const u=[Ou,vr],c=window.spwashi.__session.i++,l=u[c%u.length];window.spwashi.links=l(window.spwashi.nodes),window.spwashi.reinit()}],["speed decay",()=>{const u=["0.1","0.2","0.3","0.4","0.5"],c=window.spwashi.__session.i++;window.spwashi.parameters.forces.velocityDecay=u[c%u.length],window.spwashi.reinit()}],["box",()=>{window.spwashi.parameters.forces.boundingBox=!window.spwashi.parameters.forces.boundingBox,window.spwashi.reinit()}]]}],s=document.querySelector("#reflexes");let a=0;o.forEach(({title:u,reflexes:c})=>{const l=s.appendChild(document.createElement("section"));l.classList.add("card");const f=l.appendChild(document.createElement("header"));f.classList.add("card-header");const d=l.appendChild(document.createElement("div"));d.classList.add("card-body");const h=d.appendChild(document.createElement("div"));h.classList.add("button-container"),f.innerText=u,c.forEach(x=>{const w=h.appendChild(document.createElement("button"));w.innerText=x[0],w.onclick=()=>{x[1](),V(null),document.querySelector("#mode-selector--reflex").focus()},w.dataset.actionindex=Ru(a++)})})}function Lu(){document.querySelector("#reflexes button").focus();const t=document.querySelectorAll("#reflexes button"),e={},n={};t.forEach(i=>{const r=i.getBoundingClientRect(),o=Math.round(r.x),s=Math.round(r.y);e[o]||(e[o]=[]),n[s]||(n[s]=[]),e[o].push(i),n[s].push(i)}),window.spwashi.callbacks.arrowLeft=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().y),o=n[r],s=o.indexOf(i),a=o[s-1]||o[o.length-1];a&&a.focus()},window.spwashi.callbacks.arrowRight=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().y),o=n[r],s=o.indexOf(i),a=o[s+1]||o[0];a&&a.focus()},window.spwashi.callbacks.arrowUp=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().x),o=e[r],s=o.indexOf(i),a=o[s+1]||o[0];a&&a.focus()},window.spwashi.callbacks.arrowDown=()=>{const i=document.activeElement,r=Math.round(i.getBoundingClientRect().x),o=e[r],s=o.indexOf(i),a=o[s-1]||o[o.length-1];a&&a.focus()}}function Fu(){const t=()=>{};window.spwashi.callbacks.arrowUp=t,window.spwashi.callbacks.arrowDown=t,window.spwashi.callbacks.arrowLeft=t,window.spwashi.callbacks.arrowRight=t}function Pu(){document.body.dataset.interfaceDepth="standard"}function Bu(){zu(),window.spwashi.onModeChange=(t,e=!1)=>{var i,r,o,s,a;t&&window.spwashi.setItem("mode",t,"focal.root"),(i=document.querySelector('[data-mode-action] [aria-selected="true"]'))==null||i.setAttribute("aria-selected","false");const n=document.querySelector(`#mode-selector--${t}`);switch(n&&(n.setAttribute("aria-selected","true"),Pe(),document.body.dataset.interfaceDepth==="main-menu"?Eu(n):et.fx||Kt({x:window.innerWidth*.2,y:window.innerHeight*.75})),Fu(),t){case"spw":const u=document.querySelector("#spw-mode-container");u.tabIndex=0,e&&u.focus();break;case"reflex":Lu();break;case"color":Mu();break;case"story":const l=document.querySelector("#story-mode-container").querySelector(".button-container button");l.focus(),l.onfocus=()=>l.tabIndex=0;break;case"node":const f=document.querySelector("#node-input-container");f.tabIndex=0,f.focus(),f.onfocus=()=>f.tabIndex=0;break;case"map":(o=(r=window.spwashi.callbacks).onMapMode)==null||o.call(r);break;case"filter":(a=(s=window.spwashi.callbacks).onFilterMode)==null||a.call(s);break}Pu()},window.spwashi.onDataIndexChange=t=>{}}function qu(t){const e=new Image;return e.src=t,window.spwashi.setItem("parameters.page-image.url",t),e}function Ir(){const t=document.querySelector("#main-image-container");t.innerHTML="";const e=window.spwashi.getItem("parameters.page-image.url");if(e){const n=new Image;n.src=e,t.appendChild(n)}}function Hu(){window.location.href="/"}function Xu(t){{t.valueStrings.push("add=10"),t.valueStrings.push("bonk"),t.valueStrings.push("boundingBox=1"),t.valueStrings.push("charge=-100"),t.valueStrings.push("velocityDecay=0.9"),t.valueStrings.push("nodeCount=1"),t.valueStrings.push("boon"),t.valueStrings.push("bonk"),t.valueStrings.push("nodeCount=3"),t.valueStrings.push("boon"),t.valueStrings.push("bonk"),t.valueStrings.push("minimalism"),t.nextDocumentMode="spw";return}}function Yu(t){{const e=cu(n=>n.id).join(`
`);t.valueStrings.push(e),t.nextDocumentMode="spw";return}}function Uu(){const t=J();q(G.cacheNode),window.spwashi.setItem("parameters.nodes-input",t),window.spwashi.setItem("parameters.nodes-input-map-fn-string","data => data"),window.spwashi.refreshNodeInputs()}function Ku(){Uu()}function yi(){q(t=>{t.fx=t.fy=void 0})}function Gu(){q(t=>{t.fx=t.x,t.fy=t.y})}function Vu(t){return"cluster:"+t.colorindex}function ju(t){const e=window.spwashi.nodes.reduce((n,i)=>{const r=Vu(i);return n[r]=n[r]||[],n[r].push(i),n},{});jl(),Object.entries(e).forEach(([n,i])=>{const r={identity:n,kind:"__cluster",r:100};j(r),i.forEach(o=>{_t(window.spwashi.links,{source:r,target:o,strength:1})})}),t.physicsChange=!0}function Ju(){{window.spwashi.minimalism=!0,Dn(),document.body.dataset.displaymode="nodes";return}}function Wu(t){q(e=>{e.x=Math.random()*1e3,e.y=Math.random()*1e3}),t.physicsChange=!0}function Qu(t){const e=J();e.forEach((n,i)=>{const r=e[i],o=e[(i+1)%e.length];_t(window.spwashi.links,{source:r,target:o,strength:.1})}),t.physicsChange=!0}function Zu(){{window.spwashi.bone();return}}function tf(){q(t=>{t.stroke="red"})}function ef(){{window.spwashi.boon();return}}function nf(){{window.spwashi.honk();return}}function rf(){{window.spwashi.bonk();return}}function of(t){const e=document.querySelector("title").innerText;t.nextDocumentMode="spw",t.valueStrings.push(`${e}`)}function sf(){{const t=new URLSearchParams;t.set("display","nodes"),Fe(t)}}function af(){{window.spwashi.setItem("parameters.page-image",""),Ir();return}}function cf(){An(),yr(),tt(),Pe().focus()}function lf(t){_r(),t.physicsChange=!0}function uf(t){const e=t.valueStrings[0];q(n=>n.collisionRadius=parseInt(e)),t.physicsChange=!0}function ff(t){t.valueStrings.push("https://spwashi.com","https://lore.land","https://boon.land","https://bane.land","https://bone.land","https://bonk.land","https://honk.land","https://boof.land","https://factshift.com"),t.nextDocumentMode="spw"}function df(t){const e=J(),n=[Tn(mr),pt([0,e.length],i=>`hsl(${i*360}, 100%, 50%)`)][1];e.forEach((i,r)=>{i.color=n(r)})}function hf(t){const e=J(),n=window.spwashi.parameters.width,i=window.spwashi.parameters.height;e.forEach((r,o)=>{r.x=o%5*n/5,r.y=Math.floor(o/5)*i/5}),t.nodesImpacted=e,t.physicsChange=!0}const pf=t=>{t.valueStrings.push(...Object.keys(hn).filter(e=>!["options","clear","save","home","help"].includes(e)).map(e=>e+`
`)),t.nextDocumentMode="spw"},hn={home:()=>Hu(),clear:()=>cf(),save:()=>Ku(),freeze:()=>Gu(),unfreeze:()=>yi(),unfix:()=>yi(),help:t=>Au(t),spwashi:t=>ff(t),color:t=>df(),forces:t=>lf(t),cr:t=>uf(t),all:t=>Yu(t),clicked:t=>Pl(t),cluster:t=>ju(t),scatter:t=>Wu(t),arrange:t=>hf(t),demo:t=>Xu(t),link:t=>Qu(t),title:t=>of(t),minimalism:()=>Ju(),boon:()=>ef(),bane:()=>tf(),bone:()=>Zu(),honk:()=>nf(),bonk:()=>rf(),nodesonly:()=>sf(),noimage:()=>af(),[Sr]:()=>yu(),options:pf};function wf(t,e){t.valueStrings.push(e),t.liveStrings.push(e)}function mf(t,e){return hn[t]?hn[t](e):wf(e,t)}const gf={regex:/^add=(-?\d+)/,handler:(t,e)=>{const n=parseInt(e),i=[...Array(n)].map((r,o)=>({name:o+"",id:Date.now()+Math.random()}));j(...i.map(G.normalize).map(Zt)),t.nodesAdded.push(...i),t.physicsChange=!0}},yf={regex:/^@=(.+)/,handler:(t,e)=>{e.split(",").forEach(i=>{const r=window.spwashi.nodes.find(o=>o.id===i||o.identity===i);r&&t.nodesImpacted.push(r)}),t.physicsChange=!0}},xf={regex:/^box=(-?\d+)/,handler:(t,e)=>{window.spwashi.parameters.forces.boundingBox=!!parseInt(e),t.physicsChange=!0}},vf={regex:/^charge=(-?\d+)/,handler:(t,e)=>{window.spwashi.parameters.forces.charge=parseInt(e),t.physicsChange=!0}},_f={regex:/^cr=(\d+)/,handler:(t,e)=>{q(n=>n.collisionRadius=parseInt(e)*n.r),t.physicsChange=!0}},kf={regex:/^color=(-?\d+)/,handler:(t,e)=>{const n=parseInt(e),i=Math.sign(n)!==-1||Object.is(n,-0),r=[...window.spwashi.nodes];i&&r.reverse();const o=[Tn(mr),pt([0,r.length],a=>`hsl(230, ${a*100}%, 50%)`),pt([0,r.length],a=>`hsl(230, 100%, ${a*50}%)`),pt([0,r.length],a=>`hsl(${a*360}, 100%, 50%)`)],s=o[Math.abs(n)%o.length];r.forEach((a,u)=>{console.log(a.name),a.color=s(u)}),t.physicsChange=!0}},bf={regex:/^fontSize=(\d+)/,handler:(t,e)=>{const n=parseInt(e);J().forEach((r,o)=>{r.text.fontSize=n}),t.physicsChange=!0}},Sf={regex:/^name=(.+)/,handler:(t,e)=>{const n=e,i=J(),o={identity:s=>s.identity,name:s=>s.private.name||s.name,url:s=>s.url,hash:s=>Li(s),pos:(s,a)=>`${a}`}[n];o&&(i.forEach((s,a)=>{s.private.name=s.private.name||s.name,s.name=o(s,a)||s.name}),t.physicsChange=!0)}},Nf={regex:/^nodeCount=(\d+)/,handler:(t,e)=>{window.spwashi.parameters.nodes.count=parseInt(e),t.physicsChange=!0}},Mf={regex:/^r=(\d+)/,handler:(t,e)=>{q(n=>n.r=parseInt(e)),t.physicsChange=!0}},Cf={regex:/^size=(\d+)/,handler:(t,e)=>{const n=parseInt(e),i=J(),r=[pt([0,i.length],s=>s*30),pt([0,i.length],s=>s*60),pt([0,i.length],s=>s*90),pt([0,i.length],s=>s*120)],o=r[n%r.length];i.forEach((s,a)=>{s.r=o(a)}),t.physicsChange=!0}},Ef={regex:/^sort=(.+)/,handler:(t,e)=>{const n=e,i=J(),o={name:(s,a)=>s.name.localeCompare(a.name),"name+":(s,a)=>s.name.localeCompare(a.name),"name-":(s,a)=>a.name.localeCompare(s.name),r:(s,a)=>s.r-a.r,"r+":(s,a)=>s.r-a.r,"r-":(s,a)=>a.r-s.r,cluster:(s,a)=>s.colorindex-a.colorindex,"cluster-":(s,a)=>s.colorindex-a.colorindex,"cluster+":(s,a)=>a.colorindex-s.colorindex,z:(s,a)=>s.z-a.z,"z+":(s,a)=>s.z-a.z,"z-":(s,a)=>a.z-s.z}[n];o&&(i.sort(o),t.physicsChange=!0)}},Tf={regex:/^!(.+)/,handler:(t,e)=>{window.spwashi.superpower={name:e,intent:1},t.physicsChange=!0}},Af={regex:/^https:\/\/(.+)/,handler:(t,e)=>{const n={name:e,url:`https://${e}`,collisionRadius:30,r:20,charge:-1e3,fx:window.spwashi.parameters.width/2};j(n),t.nodesAdded.push(n),t.valueStrings.push(n.url)}},If={regex:/^velocityDecay=(-?\d*\.?\d+)/,handler:(t,e)=>{window.spwashi.parameters.forces.velocityDecay=parseFloat(e),t.physicsChange=!0}},zf={at:yf,add:gf,box:xf,charge:vf,velocityDecay:If,nodeQueue:Nf,collisionRadius:_f,radius:Mf,superpower:Tf,url:Af,color:kf,size:Cf,sort:Ef,name:Sf,fontSize:bf};function Df(t,e){let n=!1;if(Object.entries(zf).forEach(([i,{regex:r,handler:o}])=>{const s=r.exec(t);if(s&&s[1]){n=!0;const a=s.slice(1);o(e,...a)}}),!n)return mf(t,e),!1}function Xd(){const t=window.spwashi.getItem("parameters.spw-parse-field")||"",e=document.querySelector("#spw-parse-field");return e.value=t,e.addEventListener("paste",n=>{const i=(n.clipboardData||n.originalEvent.clipboardData).items;for(const o of i)if(o.type.indexOf("image")===0){const s=o.getAsFile();var r=new FileReader;r.onload=function(a){const u=a.target.result;qu(u)},r.readAsDataURL(s),Ir()}}),e}function Of(t){const e={physicsChange:!1,nextDocumentMode:"",liveStrings:[],valueStrings:[],nodesAdded:[],nodesImpacted:[],nodesIgnored:[]},n={};return q(r=>{r.stroke=void 0,n[r.id]=r}),t.split(`
`).map(r=>{if(n[r]){e.nodesIgnored.push(n[r]);return}Df(r,e)}),e.nodesAdded.forEach(r=>{r.stroke="red",G.normalize(r),Zt(r)}),e.nodesIgnored.forEach(r=>{r.r=10}),e.nodesImpacted.forEach(r=>{r.stroke="rgb(222,184,135)",r.strokeWidth=5}),e.physicsChange&&tt(),{nextDocumentMode:e.nextDocumentMode,liveStrings:e.liveStrings,valueStrings:e.valueStrings}}class re{constructor(e,n=void 0,i=!1){this._head=e,this._operator=n,this._isPrefixed=i}operator(e){if(!e)return this._operator;this._operator=e}get parts(){const e=[this._head,this._operator];return this._isPrefixed?e.reverse():e}}class $f extends re{}class Rf extends re{get parts(){return this._isPrefixed?super.parts.reverse():super.parts}}class Lf extends re{}class Ff extends re{}class Pf{constructor(e){this._seedNode=e,this.fillOperator=Bf(e)}get seedNode(){return this._seedNode}initTail(){const e=this.seedNode;if(!e.tail)return;this._trailingOperator;const n=e.tail;return this._tail=new Ff(n),this._tail}initBody(){const e=this.seedNode,n=e==null?void 0:e.body;if(!n)return;const i=[];for(const r of n)this._trailingOperator=this.fillOperator(),i.push(new Rf(r,this._trailingOperator,!1));return this._body=new Lf(i),this._body}initHead(){const e=this.seedNode;let n=this.fillOperator();return e.head&&(this._head=new $f(e.head,n),n=void 0),this._trailingOperator=n,this._head}*produce(){const e=this.initHead();e&&(yield e);const n=this.initBody();n&&(yield n);const i=this.initTail();i&&(yield i)}}function Bf(t){let e=0;return function(){var n;const i=(n=t.operators)===null||n===void 0?void 0:n[e];return e++,i}}class $n{constructor(e,n=void 0){var i,r;this._generation=((i=e==null?void 0:e._generation)!==null&&i!==void 0?i:-1)+1,this._context=n??e,this._root=(r=e._root)!==null&&r!==void 0?r:e}spawn(e){return new $n(this,e)}key(e){return e}*loop(e){if(Array.isArray(e)){for(const i of e)yield e;return}if(!e)return;yield*new Pf(e).produce()}}class zr{constructor(e=void 0){this.generators=[],this.Cursor=Dr,this.source=e}getCursor(e){return new this.Cursor({input:e,generators:this.generators})}*locate(e){yield new $n(e)}}class Qt extends zr{reduce(e,n=void 0){if(e instanceof re)return this._reduceArray(e.parts,n);if(typeof e>"u"||e===null){this._reduceNothing();return}return Array.isArray(e)?this._reduceArray(e,n):typeof e=="string"?this._reduceString():e.key?this._reduceAtom(e,n):this._reduceNode(e,n)}_reduceNode(e,n){const i=n.spawn(e),r=[];for(const a of i.loop(e)){const u=this.reduce(a,i);u&&r.push(u)}const o=Qt.doFlatten?r.flat():r;return(Qt.doFlatten?!1:!n.generation)?{kind:e.kind,key:o}:o}_reduceNothing(){}_reduceAtom(e,n){return n.key(e)}_reduceString(){return null}_reduceArray(e,n){const i=[];for(const r of e){const o=this.reduce(r,n);o&&i.push(o)}return i.length<2?i[0]:i.flat()}}Qt.doFlatten=!0;class Be{constructor(e){this._kind=[],this.cursor=e}set kind(e){this._kind.push(e)}get kind(){return this._kind.join(" ")}get identity(){const e=[],n=new Qt(this);for(const r of n.locate(this)){const o=n.reduce(this,r);o&&e.push(o)}this.head,this.body,this.tail,this.kind;function i(r){return r.key?r.key:Array.isArray(r)?r.map(i).join(""):r}return e.reduce((r,o)=>""+r+i(o),"")}toJSON(){return Object.fromEntries(Object.entries({identity:this.identity,kind:[...this._kind].join(Be.kindJunctionStr),head:this.head,body:this.body,tail:this.tail}).filter(([,e])=>!!e))}}Be.kindJunctionStr=" + ";var de=function(t,e,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(t,n):r?r.value=n:e.set(t,n),n},he=function(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)},xe,xt;class Dr{constructor(e,n){var i;xe.set(this,void 0),xt.set(this,void 0),this.__log_taken=[],this.offset=(e==null?void 0:e.offset)||0,this.start=(i=n==null?void 0:n.start)!==null&&i!==void 0?i:this.offset,this.input=e==null?void 0:e.input,this.generators=e==null?void 0:e.generators,this.level=typeof(e==null?void 0:e.level)<"u"?e.level+1:0,de(this,xe,n||e||void 0,"f"),de(this,xt,null,"f")}spawn(e){const n=this.constructor;return new n(this,e)}get parent(){return he(this,xe,"f")}setOffset(e){this.offset=e.offset}curr(){return this.input[this.offset]}*scan(e=void 0,n){const i=e??this.generators;if(!i)throw new Error("Cannot scan without generators");let r=n;for(const o of i){const s=yield*o(this,r),a=s?s.getToken():!1;a&&(this.setOffset(s),a!==(r==null?void 0:r.getToken())&&(yield s),r=s)}return r}*log(e){{const n="	".repeat(this.level);yield`${n}${this}`,yield`${n}	${e.message}`,e.miss&&(yield`${n}		reason: ${e.miss}`)}}*take(){const e=this.pos();return this.__log_taken.push(e),yield e,this.advance(),e}advance(){this.offset=this.offset+1}pos(){return{kind:"pos",offset:this.offset}}getToken(){return he(this,xt,"f")}token(e){var n;return e===!1?(de(this,xt,e,"f"),this):(de(this,xt,(n=he(this,xt,"f"))!==null&&n!==void 0?n:new Be(this),"f"),Object.assign(he(this,xt,"f"),e),this)}static isCursorPosition(e){return e?typeof e.offset<"u"&&e.kind==="pos":!1}}xe=new WeakMap,xt=new WeakMap;class Or extends Dr{static isCharacterCursor(e){return typeof(e==null?void 0:e.start)<"u"}toString(){const e=this.toJSON();return`(line: ${e.start.line}, col: ${e.start.col})`}pos(){return Object.assign(Object.assign({},super.pos()),{key:this.curr()})}toJSON(){var e,n;const i=this.offset-1,r=this.input.slice(0,this.start).split(`
`),o=r.length,s=this.text,a=s.split(`
`);return{level:this.level,start:{line:o,col:(((e=r.pop())===null||e===void 0?void 0:e.length)||1)-1,offset:this.start},end:{line:o+a.length-1,col:(((n=a.pop())===null||n===void 0?void 0:n.length)||1)-1,offset:i},text:s}}get text(){return this.input.slice(this.start,this.offset)}}var qf=function(t,e,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(t,n):r?r.value=n:e.set(t,n),n},pe=function(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)},ve,_e,$r,Rr,Lr;class ht{constructor(e){_e.set(this,void 0),qf(this,_e,e,"f")}*scan(e){let n,i,r=pe(this,_e,"f").getCursor(e);for(yield*r.log({message:"beginning loop"});r.curr();){if(r=yield*r.scan(),!r){yield{error:!0,message:"did not generate a token"};break}try{i=yield*pe(ht,ve,"m",Lr).call(ht,r,i)}catch(o){r=!1,n=o;break}}return r?(yield*pe(ht,ve,"m",Rr).call(ht,r),r.getToken()):(yield*pe(ht,ve,"m",$r).call(ht,n),!1)}getCursor(e){return new Or({input:e})}}ve=ht,_e=new WeakMap,$r=function*(e){yield{success:!1,error:!0,message:{error:e}},yield!1},Rr=function*(e){yield*e.log({success:!0,message:"ending loop"}),yield e.getToken()},Lr=function*(e,n){const i=e?e.getToken():null;if(!i&&n)throw yield*e.log({error:!0,message:"token stream broke",info:{currentToken:i,prevCursor:n}}),new Error("token stream broke");if((n==null?void 0:n.offset)===e.offset)throw yield*e.log({error:!0,message:"cursor did not change positions"}),new Error("token stream broke");return e};function Hf(t){const e=t.curr();return e?/\d/.test(e):!1}function Je(t){const e=t.curr();return e?/\d/.test(e):!1}function*It(t,e){const n=t.spawn(e);if(n.token({kind:"numeric"}),e)return yield*n.log({message:"not numeric",miss:"cannot follow prev",cursors:{start:t,prev:e}}),e;const{integral:i,fractional:r}=yield*Xf(n);if(!(i.length||r.length))return yield*n.log({message:"not numeric",miss:"no integral or fractional components"}),!1;yield*n.log({message:"resolving numeric"});const o=i.length?parseInt(i.join("")):0,s=r.length?parseFloat(`.${r.join()}`):void 0,a={key:o+(s??0)};return n.token({head:a,integral:o,fractional:s}),n}function*Xf(t){const e=[];{let i=Hf,r;for(;i(t);)!r&&(r=!0)&&(i=Je,yield*t.log({message:"beginning numeric",info:{component:"integral"}})),e.push(t.curr()),yield*t.take()}const n=[];if(t.curr()==="."){yield*t.take();let i=!1,r=Je;for(;r(t);)!i&&(i=!0)&&(r=Je,yield*t.log({message:"continuing numeric",info:{component:"fractional"}})),n.push(t.curr()),yield*t.take()}return{integral:e,fractional:n}}function Fr(t){return t?/[a-zA-Z]/.test(t):!1}function Yf(t){return t?Fr(t)||t==="_":!1}const xi={name:"conceptual.open",key:"<",opposite:">",kind:"delimiter",open:!0},vi={name:"locational.open",key:"(",opposite:")",kind:"delimiter",open:!0},_i={name:"structural.open",key:"{",opposite:"}",kind:"delimiter",open:!0},ki={name:"essential.open",key:"[",opposite:"]",kind:"delimiter",open:!0},bi={name:"conceptual.close",key:">",opposite:"<",kind:"delimiter",close:!0},Si={name:"locational.close",key:")",opposite:"(",kind:"delimiter",close:!0},Ni={name:"structural.close",key:"}",opposite:"{",kind:"delimiter",close:!0},Mi={name:"essential.close ",key:"]",opposite:"[",kind:"delimiter",close:!0},Uf={"<":xi,"(":vi,"{":_i,"[":ki,_inverse:{">":xi,")":vi,"}":_i,"]":ki}},Kf={">":bi,")":Si,"}":Ni,"]":Mi,_inverse:{"<":bi,"(":Si,"{":Ni,"[":Mi}},pn={open:Uf,close:Kf};function Gf(t){const e=t.curr();return e?!!pn.open[e]:!1}function Pr(t){return t.curr()===" "}function*F(t){const e=[];for(;Pr(t);)e.push({key:t.curr()}),yield*t.take();return e}const Br={"*":{name:"salience",key:"*",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"@":{name:"perspective",key:"@",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},":":{name:"binding",key:"@",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"+":{name:"aggregation",key:"+",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"-":{name:"reduction",key:"-",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])},"=":{nodes:{">":{name:"transformation",key:"=>",kind:"pragmatic",kinds:new Set(["pragmatic","nominal"])}}}};function*Vf(t,e=Br){let n=t.curr(),i=e[n];const r=[];for(;e[n];){if(r.push(n),i=e[n],!i.nodes){t.advance();break}e=i.nodes,yield*t.take(),n=t.curr()}return[i,r.join("")]}function*jf(t){let e=!1,n;return t.curr()==="_"&&(n=yield*t.take(),e=yield*t.scan([zt,It,kt])),[n,e]}function At(t){return function*(e){const n=e.spawn();n.token({kind:"operator"}),yield*n.log({message:"checking operator"});const[i,r]=yield*Vf(n,t);if(i&&(n.token({proto:i}),n.token({kind:i.kind}),n.token({kind:i.name})),!i)return yield*n.log({message:"not an operator",miss:"no prototype",cursors:{start:e},info:{operators:t,curr:e.curr()}}),!1;const[o,s]=yield*jf(n);return n.token({body:[{key:r}],operators:o?[o]:void 0,tail:s?s.getToken():void 0}),n}}const Jf=[zt,It,kt];function*oe(t,e){const n=t.spawn(e);if(n.token({kind:"phrasal"}),yield*n.log({message:"checking phrasal"}),!e)return yield*n.log({message:"not phrasal",miss:"no head",cursors:{start:t,prev:e}}),!1;const{head:i,body:r,tail:o,operators:s}=yield*Wf(n,e);return o?(yield*n.log({message:"resolving phrasal"}),n.token({head:i,body:r,tail:o,operators:s}),n):(yield*n.log({message:"not phrasal",miss:"no tail",cursors:{start:t,prev:e,cursor:n},info:{head:i,body:r,tail:o,operators:s}}),e??!1)}function*Wf(t,e){const n=e&&e.getToken(),i=[],r=[];{let s=!1;for(;Pr(t);){!s&&(s=!0)&&(yield*t.log({message:"beginning ordinal"}));const a=yield*F(t);r.push(a),yield*F(t);const u=yield*t.scan(Jf),c=u?u.getToken():null;if(!c)break;i.push(c)}}const o=i.pop();return{head:n,body:i,tail:o,operators:r}}function Qf(t){return t.curr()===","}const Zf=[zt,It,kt,oe],td={",":{name:"common",key:",",kind:"delimiter"}},ed={";":{name:"ordinal",key:";",kind:"delimiter"},"\n":{name:"ordinal",key:";",kind:"delimiter"}};function*Rn(t,e){const n=t.spawn(e);n.token({kind:"common"}),yield*n.log({message:"checking common"});const{head:i,body:r,tail:o,operators:s}=yield*nd(n,e);return s.length?(yield*n.log({message:"resolving common"}),n.token({head:i,body:r,tail:o,operators:s}),n):(yield*n.log({message:"not common",miss:"no operators"}),e??!1)}function*nd(t,e){yield*F(t);const n=e&&e.getToken(),i=[],r=[];let o=!1;for(;Qf(t);){!o&&(o=!0)&&(yield*t.log({message:"beginning common"})),yield*F(t);const a=yield*t.scan([At(td)]),u=a==null?void 0:a.getToken();if(!u)break;r.push(u),yield*F(t);const c=yield*t.scan(Zf);let l=c?c.getToken():null;l||(l=null),i.push(l),yield*F(t)}const s=i.pop();return{head:n,body:i,tail:s,operators:r}}function id(t){return t.curr()===";"||t.curr()===`
`}const rd=[zt,It,kt,oe,qe];function*qe(t,e,n=Br){var i;const r=t.spawn(e);r.token({kind:"operational"}),yield*r.log({message:"checking operational"});let{head:o,body:s,tail:a,operators:u,initialProto:c}=yield*od(r,e,n);return u.length?(((i=c==null?void 0:c.kinds)===null||i===void 0?void 0:i.has("nominal"))&&!a&&(a=null),r.token({operators:u}),(c==null?void 0:c.kind)==="delimiter"?r:(u.length===1&&(r.token({kind:c.kind}),r.token({kind:c.name})),typeof a>"u"?(yield*r.log({message:"not operational",miss:"missing a tail component",cursor:r,info:{head:o,body:s,tail:a,tok:r.getToken()}}),r.token(!1),!1):(yield*r.log({message:"resolving operational",cursor:r}),!o&&!a&&r.token({kind:"conceptual"}),r.token({head:o,body:s,tail:a}),r))):(yield*r.log({message:"not operational",miss:"no operators"}),!1)}function*od(t,e,n){const i=e&&e.getToken(),r=[],o=[];n[" "]||(yield*F(t));let s,a;for(;s=yield*t.scan([At(n)]);){if(!s)continue;if(!(s!=null&&s.getToken()))break;yield*t.log({message:"beginning operational"}),o.push(s.getToken());const c=s.getToken().proto;if(a=a||c,c.open){const d=yield*F(s);d.length&&r.push(d[0])}c.close||(yield*F(t));const l=yield*t.scan(rd,c.close?s:void 0),f=l?l.getToken():null;if(!f)break;r.push(f),yield*F(t)}const u=r.pop();return{head:i,body:r,tail:u,operators:o,initialProto:a}}const sd=[zt,It,kt,oe,Rn,qe];function*qr(t,e){const n=t.spawn(e);n.token({kind:"ordinal"}),yield*n.log({message:"checking ordinal"});const{head:i,body:r,tail:o,operators:s}=yield*cd(n,e);return s.length?(yield*n.log({message:"resolving ordinal"}),n.token({head:i,body:r,tail:o,operators:s}),n):(yield*n.log({message:"not ordinal",miss:"no operators"}),e??!1)}const ad=At(ed);function*cd(t,e){yield*F(t);const n=e&&e.getToken(),i=[],r=[];let o;{let a=!1;for(;id(t);){!a&&(a=!0)&&(yield*t.log({message:"beginning ordinal"})),yield*F(t);const u=yield*t.scan([ad]),c=u==null?void 0:u.getToken();if(!c)break;!o&&r.push(o=[]),o.push(c),yield*F(t);const l=yield*t.scan(sd);let f=l?l.getToken():null;f?o=null:f=null,i.push(f),yield*F(t)}}const s=i.pop();return{head:n,body:i,tail:s,operators:r}}const Ci={name:"open-conceptual",key:'"',opposite:'"',kind:"delimiter",open:!0},Ei={name:"open-locational",key:"`",opposite:"`",kind:"delimiter",open:!0},Ti={name:"close-conceptual",key:'"',opposite:'"',kind:"delimiter",close:!0},Ai={name:"close-locational",key:"`",opposite:"`",kind:"delimiter",close:!0},ld={'"':Ci,"`":Ei,_inverse:{'"':Ci,"'":Ei}},ud={'"':Ti,"`":Ai,_inverse:{'"':Ti,"`":Ai}},wn={open:ld,close:ud};function fd(t){const e=t.curr();return e?!!wn.open[e]:!1}function Hr(t){return t?t!=='"'&&t!=="`":!1}function dd(t){return t?Hr(t)||t==="_":!1}function*hd(t,e){const n=t.spawn(e);if(n.token({kind:"anything"}),yield*n.log({message:"checking anything"}),e)return yield*n.log({message:"not anything",miss:"cannot follow prev"}),e;const i=yield*pd(n);if(!i.length)return yield*n.log({message:"not anything",miss:"no key"}),!1;yield*n.log({message:"resolving anything"});const r={key:i};return n.token({head:r}),n}function*pd(t){const e=[];{let n,i=Hr;for(;t.curr()&&i(t.curr());)!n&&(n=!0)&&(yield*t.log({message:"beginning anything"})),e.push(t.curr()),yield*t.take(),i=dd}return e}const wd=[hd];function*Xr(t,e){const n=t.spawn(e);if(n.token({kind:"literal"}),yield*n.log({message:"checking literal"}),e)return yield*n.log({message:"not literal",miss:"prev"}),e;if(!fd(t))return yield*n.log({message:"not literal",miss:"cursor cannot start literal"}),!1;const{head:i,body:r,tail:o}=yield*md(n);return yield*n.log({message:"resolving literal"}),n.token({head:i,body:r,tail:o}),n}function*md(t){var e,n;const i=wn.open,r=yield*t.scan([At(i)]),o=r==null?void 0:r.getToken(),s=(e=o==null?void 0:o.label)===null||e===void 0?void 0:e.key,a=wn.close._inverse[o.proto.key];if(!a)throw new Error("could not resolve type");yield*F(t);let u,c;const l=[];for(;t.curr();){!u&&(u=!0)&&(yield*t.log({message:"beginning literal"})),yield*F(t);const f=yield*t.scan([At({[a.key]:a})]),d=f==null?void 0:f.getToken(),h=(n=d==null?void 0:d.label)===null||n===void 0?void 0:n.key;if(d){if(h===s||!(h&&s)){c=d;break}l.push(d),yield*F(t)}const x=yield*t.scan(wd);if(!x)break;l.push(x==null?void 0:x.getToken()),yield*F(t)}return{head:o,body:l,tail:c}}const gd=[zt,It,kt,Xr,oe,Rn,qr,qe];function*kt(t,e){const n=t.spawn(e);if(n.token({kind:"container"}),yield*n.log({message:"checking container"}),e)return yield*n.log({message:"not container",miss:"prev"}),e;if(!Gf(t))return yield*n.log({message:"not container",miss:"cursor cannot start container"}),!1;const{head:i,body:r,tail:o}=yield*yd(n);return n.token({kind:i.proto.name.split(".")[0]}),yield*n.log({message:"resolving container"}),n.token({head:i,body:r,tail:o}),n}function*yd(t){var e,n;const i=pn.open,r=yield*t.scan([At(i)]),o=r==null?void 0:r.getToken(),s=(e=o==null?void 0:o.label)===null||e===void 0?void 0:e.key,a=pn.close._inverse[o.proto.key];if(!a)throw new Error("could not resolve type");yield*F(t);let u,c;const l=[];for(;t.curr();){!u&&(u=!0)&&(yield*t.log({message:"beginning container"})),yield*F(t);const f=yield*t.scan([At({[a.key]:a})]),d=f==null?void 0:f.getToken(),h=(n=d==null?void 0:d.label)===null||n===void 0?void 0:n.key;if(d){if(h===s||!(h&&s)){c=d;break}l.push(d),yield*F(t)}const x=yield*t.scan(gd);if(!x)break;l.push(x==null?void 0:x.getToken()),yield*F(t)}return{head:o,body:l,tail:c}}function*xd(t){var e;const n=new Map;let i;for(;(i=yield*t.scan([kt]))&&(i=i.getToken());){const r=(e=n.get(i.head.proto))!==null&&e!==void 0?e:[];r.push(i),n.set(i.head.proto.name,r)}return n}function*vd(t){const e=yield*xd(t);t.token({definition:e}),e.size&&t.token({body:[...e.values()]})}function*zt(t,e){const n=t.spawn(e);if(n.token({kind:"nominal"}),yield*n.log({message:"checking nominal"}),e)return yield*n.log({message:"not nominal",miss:"cannot follow prev"}),e;const i=yield*_d(n);if(!i.length)return yield*n.log({message:"not nominal",miss:"no key"}),!1;yield*n.log({message:"resolving nominal"});const r={key:i};return n.token({head:r}),yield*vd(n),n}function*_d(t){const e=[];{let n,i=Fr;for(;t.curr()&&i(t.curr());)!n&&(n=!0)&&(yield*t.log({message:"beginning nominal"})),e.push(t.curr()),yield*t.take(),i=Yf}return e.join("")}const kd={literal:Xr,container:kt,nominal:zt,numeric:It},bd={operational:qe},Sd={phrasal:oe,common:Rn,ordinal:qr},Nd=Object.assign(Object.assign(Object.assign({},kd),bd),Sd);class Md extends zr{constructor(){super(...arguments),this.generators=Object.values(Nd),this.Cursor=Or}}function Cd(t,{asGenerator:e=!1}={}){if(e)return i();let n;for(const r of i())n=r;return n;function*i(){const r=new Md;yield*new ht(r).scan(t)}}function Ed(){const t=document.querySelector("h1"),e=t.innerText,n=document.querySelector("#main-wonder-button");t.tabIndex=0,t.onclick=s=>{s.target===t&&(s.stopPropagation(),o())},t.onkeydown=s=>{if(s.ctrlKey||s.metaKey){s.key==="c"&&navigator.clipboard.writeText(e);return}s.key!=="Shift"&&s.target===t&&s.key!=="Tab"&&(s.key===" "&&s.preventDefault(),!s.key.match(/\d/)&&n.click())};let i;function r(s=!0){document.removeEventListener("click",i),t.innerText=e,s&&t.focus()}function o(){const s=document.createElement("form"),a=document.createElement("input");a.onpaste=l=>{l.preventDefault();const f=l.clipboardData.getData("text/plain");br(f)},a.value=e,a.id="h1-input",s.appendChild(a);const u=document.createElement("button");u.type="submit",u.innerText="submit";let c=!0;s.appendChild(u),t.innerHTML="",t.appendChild(s),a.focus(),a.setSelectionRange(0,a.value.length),u.onclick=l=>{l.preventDefault();const f=a.value,{liveStrings:d,nextDocumentMode:h,valueStrings:x}=Of(f);if(h==="spw"){c=!1,window.spwashi.spwEditor.value=x.join(`
`),V("spw",!1,!0);return}const w=x.join(`
`);if(!w)return;const g=JSON.parse(JSON.stringify(Cd(w))),p=Qe();window.location.href=Ze(Ri(g.identity),p,g.identity)},i=()=>{r(c)},u.onblur=()=>{r(c)},document.addEventListener("click",i)}n.onclick=s=>{s.stopPropagation(),o()}}const Td=t=>{const e=t||window.spwashi.parameters.nodes.count,n=[...Array(e)].map(i=>({name:"boon",identity:Date.now()+Math.random()}));return j(...n),tt(),n};function Ad(){const t=window.spwashi.simulation;if(!t){const a="no force simulation initialized";throw alert(a),new Error(a)}const e=document.querySelector("#controls .tick");e.onclick=()=>{window.spwashi.tick()};const n=document.querySelector("#controls .start");n.onclick=()=>{t.restart()};const i=document.querySelector("#controls .stop");i.onclick=()=>{t.stop()};const r=document.querySelector("#controls .reinit");r.onclick=()=>{window.spwashi.reinit()};const o=document.querySelector("#controls .clear-fixed-positions");o.onclick=()=>{q(a=>{a.fx=void 0,a.fy=void 0})};const s=document.querySelector("#controls .generate-nodes");s.onclick=Td}const Ii=(t,e=null)=>(e||(e=window.spwashi.parameterKey),e+"@"+t);function Id(){window.spwashi.__session=window.spwashi.__session||{i:0},window.spwashi.setItem=(t,e,n=null)=>{window.localStorage.setItem(Ii(t,n),JSON.stringify(e||null))},window.spwashi.getItem=(t,e=null)=>{const n=window.localStorage.getItem(Ii(t,e));if(n)return JSON.parse(n||"{}")}}function zd(){Id(),Iu(),Bu(),window.spwashi.counter=0,window.spwashi.modeOrder=["reflex","color","map","filter","node","query","debug","story","spw"],mn(()=>import("./simulation-uMnGEAHf.js"),__vite__mapDeps([])).then(async({initSimulationRoot:t})=>{await t(),Ad(),window.location.pathname==="/help"&&(Ar(),window.spwashi.spwEditor.value=window.spwashi.getItem("help","focal.root")||"",V("spw",!1,!0))})}function Dd(){window.spwashi={},zd(),Cu(),Fe(new URLSearchParams(window.location.search)),Pe(),Ed(),mn(()=>import("./ui-8bP97K9-.js"),__vite__mapDeps([])).then(({initUi:t})=>t(window.spwashi.initialMode))}Dd();export{Dn as A,zn as B,Or as C,su as D,J as E,Pd as F,yr as G,xu as H,Uu as I,ru as M,G as N,In as S,Fe as a,Fd as b,An as c,Rd as d,ie as e,$d as f,Kr as g,Xd as h,Ir as i,Of as j,Pe as k,Cd as l,cu as m,Bd as n,Hd as o,j as p,Su as q,tt as r,V as s,Od as t,qd as u,gu as v,q as w,Ld as x,Td as y,Qe as z};
//# sourceMappingURL=index-gtuLhiWq.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}